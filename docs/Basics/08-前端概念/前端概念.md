

# 一、SSR/CSR

## 1-1、SSR

Server Side Rendering(服务端渲染)，将渲染的工作放在服务端进行并回传客户端，后者得到完整结构后就可直接进行 DOM 解析、构建、加载资源及后续渲染；

优点是：首屏加载快、对搜索引擎友好，利于 SEO;

缺点是：访问量较大时，会对服务器造成很大压力、页面间频繁刷新跳转体验不友好；

## 1-2、CSR

Client Side Rendering(客户端渲染)，服务器返回初始 HTML 内容，然后再通过 JS 异步加载数据，完成页面渲染，如基于vue/react 开发的 SPA 应用；

优点是：页面路由放在客户端，页面间切换快、数据渲染放在客户端大为降低服务器压力；

缺点是：首屏渲染较慢或出现白屏现象、不利于 SEO；

## 1-3、两者结合的方案

首页基于SSR，后续点击等事件交互基于 CSR 渲染，可避免首页加载较慢，又能解决SEO问题；**<u>*对于客户端和服务端代码采用同构；*</u>**

```js
// 服务端采用 react-dom/server 的 renderToString 方法，将 Index 组件直出：
const { renderToString}  = require( 'react-dom/server');
const http = require('http');

// Index 组件
class Index extends React.Component{
    constructor(props){
        super(props);
    }

    render(){
        return <h1>{this.props.data.title}</h1>
    }
}

// server服务
http.createServer((req, res) => {
    if (req.url === '/') {
        res.writeHead(200, {
            'Content-Type': 'text/html'
        });
        const html = renderToString(<Index />);
        res.end(html);
    }
}).listen(8080);
```



```js
// 客户端使用 react-dom 的 ReactDOM.hydrate 方法替代 ReactDOM.render 方法
// 它用于在 ReactDOMServer 渲染的容器中对 HTML 的内容进行 hydrate 操作 React 会尝试在已有标记上绑定事件监听器。
import ReactDOM from 'react-dom';
// 绑定 Index 组件的事件监听到页面
ReactDom.hydrate(<Index />, document.getElementById('root'));
```