(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{393:function(t,s,a){"use strict";a.r(s);var n=a(42),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h3",{attrs:{id:"一、模块规范演变"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、模块规范演变"}},[t._v("#")]),t._v(" 一、模块规范演变")]),t._v(" "),a("p",[t._v("1999 - "),a("strong",[a("u",[a("em",[t._v("直接定义依赖")])])]),t._v("：通过全局方法定义、引用模块；")]),t._v(" "),a("ul",[a("li",[t._v("此方式神似 CMJS，但 CMJS 以文件作为模块，可在任何文件中定义模块，模块不与文件关联；")])]),t._v(" "),a("p",[t._v("2003 - "),a("strong",[a("u",[a("em",[t._v("闭包模块化模式")])])]),t._v("：通过闭包内返回模块对象，只需对外暴露一个全局变量；")]),t._v(" "),a("ul",[a("li",[t._v("此方式解决了变量污染问题；")])]),t._v(" "),a("p",[t._v("2006 - 模版依赖定义：通过后端模板语法聚合 JS 文件，从而实现依赖加载；")]),t._v(" "),a("ul",[a("li",[t._v("此方式存在严重的可维护性问题；")])]),t._v(" "),a("p",[t._v("2006 - 注释依赖定义：通过 lazyjs 加载文件，同时读取文件注释，继续递归加载剩下的文件；")]),t._v(" "),a("ul",[a("li",[t._v("此方式与 1999 年方案不同的，不仅仅是模块定义方式，而是终于以文件为单位定义模块了；")])]),t._v(" "),a("p",[t._v("2007 - 外部依赖定义：将依赖抽出单独文件定义；")]),t._v(" "),a("ul",[a("li",[t._v("此方式在 Cocos2d-js 开发中普遍使用，但不利于项目管理；")])]),t._v(" "),a("p",[t._v("2009 - Sandbox 模式：将所有模块塞到一个 sanbox 变量中；")]),t._v(" "),a("ul",[a("li",[t._v("此方式无法解决冲突问题，毕竟都塞到一个 sandbox 对象里，而 Sandbox 对象也需要定义在全局，存在被覆盖的风险；")])]),t._v(" "),a("p",[t._v("2009 - "),a("strong",[a("u",[a("em",[t._v("依赖注入")])])]),t._v("：即 Angular1.0；")]),t._v(" "),a("ul",[a("li",[t._v("此思想现在已广泛运用在 react、vue 等流行框架中；")])]),t._v(" "),a("p",[t._v("2009 - "),a("strong",[a("u",[a("em",[t._v("CMJS")])])]),t._v("：真正解决模块化问题，从 Node 端逐渐发力到前端，前端需要使用构建工具模拟；")]),t._v(" "),a("p",[t._v("2009 - "),a("strong",[a("u",[a("em",[t._v("AMD")])])]),t._v("：解决前端动态加载依赖，相比 commonJs，体积更小，按需加载；")]),t._v(" "),a("p",[t._v("2011 - "),a("strong",[a("u",[a("em",[t._v("UMD")])])]),t._v("：兼容了 CMJS 与 AMD，核心思想：")]),t._v(" "),a("ul",[a("li",[t._v("若在 CMJS 环境（存在 module.exports，不存在 define），将函数执行结果交给 module.exports 实现 CMJS；")]),t._v(" "),a("li",[t._v("其余环境则用 Amd 环境的 define，实现 Amd；")])]),t._v(" "),a("p",[t._v("2012 - Labeled Modules：生不逢时；")]),t._v(" "),a("ul",[a("li",[t._v("与 CMJS 很像，无硬伤，被人遗忘；")])]),t._v(" "),a("p",[t._v("2013 - YModules：使用 provide 取代 return；")]),t._v(" "),a("ul",[a("li",[t._v("可控制模块结束时机，处理异步结果；")]),t._v(" "),a("li",[t._v("拿到第二个参数 module，可修改其他模块的定义，有一定拓展意义，但也有污染意味；")])]),t._v(" "),a("p",[t._v("2015 - "),a("strong",[a("u",[a("em",[t._v("ES2015 Modules")])])]),t._v("：现在模块化方案，还没有被浏览器实现，大部分项目已通过 babel 或 typescript 提前体验；")]),t._v(" "),a("h4",{attrs:{id:"_1-1、过去"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1、过去"}},[t._v("#")]),t._v(" 1-1、过去")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("问题：命名空间冲突(代码合并后的冲突、变量覆盖等问题)、文件依赖关系处理(重复加载、重复引用、引入不全、依赖关系复杂难以修改等问题)、其他等问题(函数群的落后注释分割、使用有限的功能但引入了整一个库文件)；")])]),t._v(" "),a("li",[a("p",[t._v("背景：网站规模越来越大、项目代码越来越复杂：")]),t._v(" "),a("ul",[a("li",[t._v("传统网页开发正在转变成 Web Apps 开发；")]),t._v(" "),a("li",[t._v("代码复杂度逐步增高，随着 Web 能力增强，越来越多业务逻辑和交互均可放在 Web 层实现；")])])]),t._v(" "),a("li",[a("p",[t._v("需求：前端模块化愈发迫切；")]),t._v(" "),a("ul",[a("li",[t._v("分离的 JS 文件/模块，可提高后续代码的维护性；")]),t._v(" "),a("li",[t._v("模块化能在部署时将代码优化成几个 HTTP 请求；")]),t._v(" "),a("li",[t._v("其他开发、版本迭代等等原因；")])])])]),t._v(" "),a("h4",{attrs:{id:"_1-2、演变"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2、演变"}},[t._v("#")]),t._v(" 1-2、演变")]),t._v(" "),a("ul",[a("li",[t._v("发展：语言在发展，在社区中学习，参考诸多优秀实现，逐步优化；")]),t._v(" "),a("li",[t._v("比如：代码分离(或文件或chunk)、代码可组合、依赖需管理、解决一致性问题；")])]),t._v(" "),a("h5",{attrs:{id:"_1-2-1、阶段一-直接定义"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-1、阶段一-直接定义"}},[t._v("#")]),t._v(" 1-2-1、阶段一 直接定义")]),t._v(" "),a("p",[a("strong",[a("u",[a("em",[t._v("阶段一：内嵌脚本 / script 标签/直接定义依赖-1999：")])])])]),t._v(" "),a("p",[t._v("问题：缺乏代码可重用性、全局变量污染、产生命名冲突、缺乏依赖解析；")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("foo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("bar")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("补充：直接定义依赖：简单粗暴，通过全局方法定义、引用模块；")]),t._v(" "),a("p",[t._v("比如：Dojo，使用 dojo.provide 定义一个模块， dojo.require 来调用在其它地方定义的模块；")]),t._v(" "),a("p",[t._v("区别：类似 CMJS，但前者可以在任何文件中定义模块，模块不和文件进行关联")]),t._v(" "),a("img",{staticStyle:{zoom:"50%"},attrs:{src:"/Image/Basics/Special/Engineering/2.png",align:"left"}}),t._v(" "),a("h5",{attrs:{id:"_1-2-2、阶段二-namespace"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-2、阶段二-namespace"}},[t._v("#")]),t._v(" 1-2-2、阶段二 NameSpace")]),t._v(" "),a("p",[a("strong",[a("u",[a("em",[t._v("阶段二：NameSpace 模式 / 对象字面量模式-2002")])])])]),t._v(" "),a("p",[t._v("意义：减轻全局变量污染情况(阶段一问题)、易于理解 & 实现；")]),t._v(" "),a("p",[t._v("问题：缺乏依赖解析、可随意读写内部变量、(方法调用长度随嵌套程度增加而增加)、无法解决代码和数据隔离问题；")]),t._v(" "),a("p",[t._v("问题：并非真正私有、只适合小型封装，否则命名空间会很长；")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("MODULE")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  name"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'TLP'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("foo")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("bar")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" obj "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("MODULE")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h5",{attrs:{id:"_1-2-3、阶段三-iife"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-3、阶段三-iife"}},[t._v("#")]),t._v(" 1-2-3、阶段三 IIFE")]),t._v(" "),a("p",[a("strong",[a("u",[a("em",[t._v("阶段三：IIFE模式-2003")])])])]),t._v(" "),a("p",[t._v("意义：不可随意读写内部变量、代码隔离、早期较为常用；")]),t._v(" "),a("p",[t._v("问题：缺乏依赖解析、所需依赖需提前提供、(闭包使用过多导致内存泄露)；")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" Module "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" _private "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'...'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("_pFn")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    fn1"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" mod1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("fn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    fn2"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" mod2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("fn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nModule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("fn1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mod1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" mod2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[a("strong",[a("u",[a("em",[t._v("阶段三又一(1/2)：模板依赖定义-2006")])])])]),t._v(" "),a("p",[t._v("意义：用于解决模块化问题的方案，需配合后端模板语法共同使用，通过后端语法聚合 JS 文件，从而实现依赖加载 (如 Prototype1.4)；")]),t._v(" "),a("p",[t._v("实现：某 JS 文件若其依赖其它 JS 文件，则可在此文件头部，加上特殊标签语法指定，随后通过后端模板引擎 (比如 erb、jinjia、smarty) 解析和特殊构建工具识别(如 borshik )；")]),t._v(" "),a("p",[t._v("局限：只能作用于预编译阶段；")]),t._v(" "),a("img",{staticStyle:{zoom:"50%"},attrs:{src:"/Image/Basics/Special/Engineering/3.png",align:"left"}}),t._v(" "),a("p",[a("strong",[a("u",[a("em",[t._v("阶段三又二(1/2)：注释定义依赖-2006")])])])]),t._v(" "),a("p",[t._v("意义：类似于1999 的直接定义依赖，但注释定义依赖是以文件为单位去定义模块，模块间的依赖关系通过注释语法进行定义；")]),t._v(" "),a("p",[t._v("实现：通过预编译方式，或运行期动态解析下载下载的代码；")]),t._v(" "),a("img",{staticStyle:{zoom:"50%"},attrs:{src:"/Image/Basics/Special/Engineering/4.png",align:"left"}}),t._v(" "),a("h5",{attrs:{id:"_1-2-4、阶段四-dependency-inject"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-4、阶段四-dependency-inject"}},[t._v("#")]),t._v(" 1-2-4、阶段四 Dependency Inject")]),t._v(" "),a("p",[a("strong",[a("u",[a("em",[t._v("阶段四：IIFE + 依赖注入-Dependency Inject - 2009")])])])]),t._v(" "),a("p",[t._v("源远：2004 年，Martin Fowler 为描述 Java 中组件间的通信问题，提出了依赖注入概念；5 年后，前 Sun 和 Adobe 员工 Miško Hevery 开始为他的创业公司设计一 JS 框架，此框架主要使用依赖注入思想去解决组件间的通信问题，后被谷歌收购；")]),t._v(" "),a("img",{staticStyle:{zoom:"50%"},attrs:{src:"/Image/Basics/Special/Engineering/5.png",align:"left"}}),t._v(" "),a("p",[t._v("意义：放开部分限制，可在内部使用其他工具库、实现装饰器模式、解耦代码与供给对象，为后来模块化发展以启示 ("),a("strong",[a("u",[a("em",[t._v("现代模块实现基石")])])]),t._v(")")]),t._v(" "),a("p",[t._v("问题：缺乏依赖解析、引入依赖数目有限；")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" Module "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("$")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// so can use jQuery")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" _$body "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("$")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"body"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("foo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Revelation Pattern")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    foo"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" foo\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("jQuery"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nModule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("foo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[a("strong",[a("u",[a("em",[t._v("阶段四又X：密集发展阶段")])])])]),t._v(" "),a("p",[t._v("问题：上述阶段对代码的封装有了很好的实践，但无解决代码依赖问题 (请求过多、依赖关系模糊、难以维护、性能问题)：")]),t._v(" "),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[t._v('// 伪码 - html\nbody\n\tscript(src="zepto.js")\n\tscript(src="jhash.js")\n\tscript(src="fastClick.js")\n\tscript(src="iScroll.js")\n\tscript(src="underscore.js")\n\tscript(src="handlebar.js")\n\tscript(src="datacenter.js")\n\tscript(src="deferred.js")\n\tscript(src="util/wxbridge.js")\n\tscript(src="util/login.js")\n\tscript(src="util/base.js")\n\tscript(src="util/city.js")\n\t// ...\n')])])]),a("p",[t._v("发展1：LAB.js - 基于文件的依赖管理—Dependency Management，"),a("a",{attrs:{href:"http://www.ruanyifeng.com/blog/2011/10/javascript_loading.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("可看"),a("OutboundLink")],1),t._v("：")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("src"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"LAB.js"')]),t._v(" async"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// First-come, First-served (when execution order is not important)")]),t._v("\n$"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("LAB")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"framework.js"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("wait")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"plugin.framework.js"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"myplugin.framework.js"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("wait")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"init.js"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// wait for all scripts to execut first")]),t._v("\n$"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("LAB")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"s1.js"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"s2.js"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"s3.js"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("wait")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("s1Func")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("s2Func")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("s3Func")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("发展2：YUI3 - 基于模块的依赖管理 - 2009，准备迈入阶段5 ("),a("strong",[a("u",[a("em",[t._v("模块化架构雏形")])])]),t._v(")，[可看]([https://www.baidu.com/s?ie=utf-8&f=8&rsv_bp=1&tn=baidu&wd=YUI%20%E6%A8%A1%E5%9D%97%E5%8C%96&oq=YUI%2520%25E5%2589%258D%25E7%25AB%25AF&rsv_pq=bc03ac140007472a&rsv_t=55428Gr%2FSFfpgrWkpfSht8tdITGrATfw3YgUBAsEfi8w%2F1WJ%2FriV8exMgJg&rqlang=cn&rsv_enter=1&rsv_dl=tb&inputT=6343&rsv_sug3=112&rsv_sug1=47&rsv_sug7=100&rsv_sug2=0&rsv_sug4=6713](https://www.baidu.com/s?ie=utf-8&f=8&rsv_bp=1&tn=baidu&wd=YUI 模块化&oq=YUI%20%E5%89%8D%E7%AB%AF&rsv_pq=bc03ac140007472a&rsv_t=55428Gr%2FSFfpgrWkpfSht8tdITGrATfw3YgUBAsEfi8w%2F1WJ%2FriV8exMgJg&rqlang=cn&rsv_enter=1&rsv_dl=tb&inputT=6343&rsv_sug3=112&rsv_sug1=47&rsv_sug7=100&rsv_sug2=0&rsv_sug4=6713))：")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// hello.js")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("YUI")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hello'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("Y")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("Y")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("sayHello")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("msg")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("Y")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("DOM")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'innerHTML'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Hello!'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'3.0.0'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" requires"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'dom'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// main.js")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("YUI")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hello'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("Y")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("Y")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sayHello")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Hi TLP'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("YUI 实际上是一个强沙箱，所有依赖模块通过 attach 方式被注入沙盒；")]),t._v(" "),a("ul",[a("li",[t._v("attach：在当前 YUI 实例上执行模块的初始化代码，使模块在当前实例上可用")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Sandbox Implementation")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Sandbox")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// initialize the required modules")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" modules"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    Sandbox"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("modules"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("modules"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Use")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("src"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/path/to/yui-mini.js"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// YUI seed")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("src"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/path/to/my/module1.js"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// add('module1')")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("src"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/path/to/my/module2.js"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// add('module2')")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("src"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/path/to/my/module3.js"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// add('module3')")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("YUI")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'module1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'module2'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'module3'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("Y")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// you can use all this module now")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("YUI 改进：YUI Combo，解决过多请求问题")]),t._v(" "),a("img",{staticStyle:{zoom:"50%"},attrs:{src:"/Image/Basics/Special/Engineering/6.png",align:"left"}}),t._v(" "),a("h5",{attrs:{id:"_1-2-5、阶段五-commonjs"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-5、阶段五-commonjs"}},[t._v("#")]),t._v(" 1-2-5、阶段五 CommonJs")]),t._v(" "),a("p",[a("strong",[a("u",[a("em",[t._v("阶段五：CommonJs - API标准 & Node - Modules/1.0-2009")])])])]),t._v(" "),a("p",[t._v("2009年，Node 诞生，JS 迈入服务器端；")]),t._v(" "),a("p",[t._v("2009年，CommonJS 规范推出，并最后在 Node 中被实现；")]),t._v(" "),a("img",{staticStyle:{zoom:"50%"},attrs:{src:"/Image/Basics/Special/Engineering/7.png",align:"left"}}),t._v(" "),a("p",[t._v("注意：在将 Node.js 中的模块发送给 V8 前，会通过下面的函数进行包裹：")]),t._v(" "),a("img",{staticStyle:{zoom:"50%"},attrs:{src:"/Image/Basics/Special/Engineering/8.png",align:"left"}}),t._v(" "),a("p",[t._v("目的：让浏览器之外的 JS (比如服务器端 / 桌面端) 能通过模块化方式来开发 & 协作：")]),t._v(" "),a("p",[t._v("基本："),a("a",{attrs:{href:"https://en.wikipedia.org/wiki/CommonJS",target:"_blank",rel:"noopener noreferrer"}},[t._v("CommonJS"),a("OutboundLink")],1),t._v(" 规范中，每 JS 文件均为独立的模块上下文 (module context)，除非是 global 顶层对象属性，否则不能访问内部定义变量 (不污染全局作用域)；")]),t._v(" "),a("p",[t._v("意义：变量作用域限制在内部，彻底解决代码封装问题，模块依赖关系变得清晰、影响 ES6 的模块语法设计；")]),t._v(" "),a("p",[t._v("问题：阻塞加载，require 调用须在代码执行前执行(预编译、无法懒加载)，异步环境使用受限(浏览器环境)")]),t._v(" "),a("p",[t._v("附加："),a("a",{attrs:{href:"http://www.ruanyifeng.com/blog/2015/05/commonjs-in-browser.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("CommonJS 在浏览器的实现"),a("OutboundLink")],1)]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 1、模块的定义与引用")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// CommonJS 规范中，使用 module.exports 输出模块变量，以建立模块外部 & 内部通信的桥梁，使用 require 加载模块；")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// math.js")]),t._v("\nexports"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("add")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" b")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" a "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// main.js")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" math "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'math'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ./math in node")]),t._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("math"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 2、同步/阻塞式加载 - Synchronously")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 注意: 同步加载对服务器/本地环境并不是问题，见下图")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// timeout.js")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("EXE_TIME")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("second")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  \t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" start "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Date")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  \t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("start "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" second "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Date")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("EXE_TIME")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2000ms executed"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// main.js")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./timeoutt'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// sync load")]),t._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'done'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("img",{staticStyle:{zoom:"50%"},attrs:{src:"/Image/Basics/Special/Engineering/9.png",align:"left"}}),t._v(" "),a("p",[t._v("CommonJS 的同步模式不适用于浏览器环境的异步模式；")]),t._v(" "),a("ul",[a("li",[t._v("同步加载阻塞渲染，如下；")]),t._v(" "),a("li",[t._v("依赖性最大文件须最后加载，但当依赖关系变复杂时，编写与维护难度变大；")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// CommonJs Syntax")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" Employee "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"types/Employee"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Programmer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ..")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Programmer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prototype "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Employee")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 问题: 若 require 异步，则铁定 error")]),t._v("\n")])])]),a("p",[a("strong",[a("u",[a("em",[t._v("为将服务器端中使用的模块语法供浏览器使用，又避免上述问题，出现两类解决方案：RequireJS & SeaJS，并逐渐形成规范")])])]),t._v("：")]),t._v(" "),a("ul",[a("li",[a("strong",[a("u",[a("em",[t._v("AMD")])])]),t._v("：RequireJS 在推广过程中，对模块定义的规范化的产出 - 2011 - JS file & modules loader - in-browser use；")]),t._v(" "),a("li",[a("strong",[a("u",[a("em",[t._v("CMD")])])]),t._v("：SeaJS 在推广过程中，对模块定义的规范化产出 - 2011 - Extremely simple experience of modular development；")])]),t._v(" "),a("h5",{attrs:{id:"_1-2-6、阶段六-acumd"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-6、阶段六-acumd"}},[t._v("#")]),t._v(" 1-2-6、阶段六 ACUMD")]),t._v(" "),a("p",[a("strong",[a("u",[a("em",[t._v("阶段六：AMD/CMD/UMD - Modules/Async or Modules/Wrappings or Modules/Transport (浏览器环境模块化方案) - 2009")])])])]),t._v(" "),a("h5",{attrs:{id:"_1-2-6-1、amd"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-6-1、amd"}},[t._v("#")]),t._v(" 1-2-6-1、AMD")]),t._v(" "),a("p",[t._v("定义：模块使用 define 定义、使用 require 调用、模块异步加载，依赖先执行；补充：采用异步方式加载模块，模块的加载不影响它后面语句的运行。所有依赖这个模块的语句，都定义在一个回调函数中，等到加载完成之后，回调函数才会运行；")]),t._v(" "),a("p",[t._v("意义：解决 Web 应用的动态加载依赖，适用于浏览器开发；")]),t._v(" "),a("p",[t._v("优点：依赖前置，异步加载，所有 require 均提前下载并执行(类似提升)，故须起初就写好依赖，加载完后，执行回调函数；")]),t._v(" "),a("p",[t._v("缺点：高开发成本，代码阅读和书写较困难、不符合通用模块思维方式，是一种妥协实现；")]),t._v(" "),a("p",[t._v("实现："),a("a",{attrs:{href:"https://requirejs.org/docs/download.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("requirejs"),a("OutboundLink")],1),t._v("、curl 、Dojo 、Nodules；")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 1、定义与暴露模块")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("define")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" dependencies"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" factory"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// define(函数(关键字), 将要依赖的项的列表, 回调函数);")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// id: 一个字符串，表示模块的名称，参数可选")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// dependencies: 一个数组，当前定义的模块要依赖于哪些模块，数组中的每一项表示的是要依赖模块的相对路径，参数可选")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// factory: 工厂方法，一个函数，具体的模块内容")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// factory-require：引入某个模块")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// factory-exports：当前模块的 exports，也就是 module.exports 的简写")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// factory-module：当前这个模块")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 注意: 回调函数的参数顺序  数组中的依赖顺序，此相当于导入模块，而回调函数返回的值即你导出的值；")]),t._v("\n       \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Ex1")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 注意模块依赖必须一开始就写好")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("define")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"xxx"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./a"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./b"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" x")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Ex2")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 创建了一个名为 alpha 的模块，使用了 require、exports、beta 模块")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("define")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"alpha"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"require"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"exports"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"beta"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("require"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" exports"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" beta")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  exports"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("verb")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" beta"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("verb")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// or")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"beta"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("verb")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Ex3")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 依赖、回调")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("define")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"type/Employee"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("Employee")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 注意：回调会在所有依赖都被加载后才执行")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Programmer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Programmer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prototype "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Employee")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" Programmer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// return Constructor")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 2、使用")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 开头加载模块")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"xxx"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"../xxx"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("xxx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" xxx")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("img",{staticStyle:{zoom:"50%"},attrs:{src:"/Image/Basics/Special/Engineering/10.png",align:"left"}}),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 注意：新建项目，并安装：npm i requirejs 才可使用 define")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Ex1 - 引用模块展示")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// math.js")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("define")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("add")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" b")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" a "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    add"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" add\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// m1.js")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 注意：须引入 requirejs 模块中的方法，而非直接使用 require，此 require 非彼 require")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" requirejs "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"requirejs"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 加载 math 模块，并在加载完成后调用 math.add 方法")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("requirejs")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'math'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("math")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("math"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 3")]),t._v("\n\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Ex2 - 多重依赖")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// m1.js")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("define")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'m1 here'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    name"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'TLP'")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// m2.js")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("define")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'m1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("m1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'m2 here'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("showName")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" m1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    showName"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" showName\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// test.js")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" requirejs "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"requirejs"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("requirejs")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'m2'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("math")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'test here'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  m2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("showName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'test first'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// test first")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// m1 here")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// m2 here")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// test here")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// TLP")]),t._v("\n")])])]),a("h5",{attrs:{id:"_1-2-6-2、cmd"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-6-2、cmd"}},[t._v("#")]),t._v(" 1-2-6-2、CMD")]),t._v(" "),a("p",[t._v("定义：模块使用 define 定义 & 调用、依赖就近(require)，延迟执行，懒加载")]),t._v(" "),a("ul",[a("li",[t._v("注意：依赖就近，延迟执行、很容易在 node 中运行、但依赖 SPM 打包，模块的加载逻辑偏重")])]),t._v(" "),a("p",[t._v("实现：seaJS；")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("define")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" dependencies"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" factory"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 与 AMD 定义一致")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// define(函数(关键字), 将要依赖的项的列表, 回调函数);")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// id: 一个字符串，表示模块的名称，参数可选")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// dependencies: 一个数组，当前定义的模块要依赖于哪些模块，数组中的每一项表示的是要依赖模块的相对路径，参数可选")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// factory: 工厂方法，一个函数，具体的模块内容")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// factory-require：引入某个模块")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// factory-exports：当前模块的 exports，也就是 module.exports 的简写")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// factory-module：当前这个模块")]),t._v("\n       \n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 1、定义与暴露模块")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("define")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'xxx'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'xxx'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("xxx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" xxx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" xxx")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 2、使用 - 加载模块")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("define")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("require"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" exports")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 依赖可就近书写")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" a "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./a'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("doSomething")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 3、完整例子：所有模块都通过 define 来定义")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("define")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("require"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" exports"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" module")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 通过 require 引入依赖")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" $ "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'jquery'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" Spinning "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./spinning'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 通过 exports 对外提供接口")]),t._v("\n  exports"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("doSomething "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 或通过 module.exports 提供整个接口")]),t._v("\n  module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h5",{attrs:{id:"_1-2-6-3、umd"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-6-3、umd"}},[t._v("#")]),t._v(" 1-2-6-3、UMD")]),t._v(" "),a("p",[t._v("是一个包装，通过判断、识别当前环境对各个规范的支持程度，以选择采用何种规范 (AMD->CommonJS->Window)")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("root"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" factory")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" define "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"function"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" define"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("amd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// AMD")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("define")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"jquery"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" factory"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"object"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// CommonJs")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" $ "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'jquery'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("factory")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("$"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 均不是则使用浏览器全局定义")]),t._v("\n    root"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("testModule "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("factory")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("root"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("jQuery"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("$")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// do something")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 真正的函数体")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("h5",{attrs:{id:"_1-2-6-4、a-cmd-对比"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-6-4、a-cmd-对比"}},[t._v("#")]),t._v(" 1-2-6-4、A & CMD 对比")]),t._v(" "),a("p",[t._v("二者均为异步模块定义—Asynchronuous Modulee Definition 的一个实现；")]),t._v(" "),a("p",[t._v("二者均为 CommonJs 的一种规范的实现定义，RequireJs 和 SeaJs 是其对应的实践；")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("前者定义模块时需指定依赖模块，并以形参方式引入 factory 中；")])]),t._v(" "),a("li",[a("p",[t._v("后者定义模块时无需立即指定依赖模块，在需要时 require 即可，属于按需引入；")])])]),t._v(" "),a("p",[t._v("AMD、CMD最大的区别是：对依赖模块的执行时机处理不同，注意不是加载的时机或者方式不同，二者皆为异步加载模块；")]),t._v(" "),a("p",[t._v("两者的 "),a("code",[t._v("define()")]),t._v(" 方法的参数都相同，但是:")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("AMD")]),t._v("，会将当前模块的依赖模块，放到 "),a("code",[t._v("dependencies")]),t._v(" 中加载，并在 "),a("code",[t._v("factory")]),t._v(" 回调中拿到加载成功的依赖；")]),t._v(" "),a("li",[a("code",[t._v("CMD")]),t._v("，一般不在 "),a("code",[t._v("dependencies")]),t._v(" 中加载，而是写在 "),a("code",[t._v("factory")]),t._v(" 中，使用 "),a("code",[t._v("require")]),t._v(" 加载某个依赖模块；")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Ex - 1")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// AMD")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("define")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'dep1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'dep2'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("dep1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" dep2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 内部只能使用指定模块")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// CMD")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("define")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("require"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" exports"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" module")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 若需某依赖时，可才再引入")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" xx "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'XXX'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Ex - 2")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// AMD")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("define")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'m1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("m1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'test here'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// CMD")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("define")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("require"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" exports"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" module")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'test here'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" m1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'m1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n  module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// AMD，先加载 m1，执行 m1，再输出 test here")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// CMD，先输出 test here，再加载 m1")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 总结")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// AMD，依赖前置，在定义模块的时候就要声明其依赖的模块")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// CMD，就近依赖，只有在用到某个模块的时候再去 require")]),t._v("\n")])])]),a("ul",[a("li",[a("p",[a("strong",[a("u",[a("em",[t._v("AMD 依赖前置 & CMD 依赖就近 更具体对比")])])])])]),t._v(" "),a("li",[a("img",{staticStyle:{zoom:"50%"},attrs:{src:"/Image/Basics/Special/Engineering/11.png",align:"left"}})]),t._v(" "),a("li",[a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 测试下述模块在 CMD-SeaJs 与 AMD-RequireJs 情况下的输出情况")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("define")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("require"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" exports"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" module")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'require module: main'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" mod1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./mod1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    mod1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("hello")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hello mod1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" mod2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./mod2'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    mod2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("hello")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hello mod2'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("        hello")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hello main'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// CMD-SeaJs-就近依赖 结果")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// require module: main")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// require module: mod1")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// hello mod1")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// require module: mod2")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// hello mod2")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// hello main")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// AMD-RequireJs-依赖前置 结果")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// require module: mod1")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// require module: mod2")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// require module: main")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// hello mod1")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// hello mod2")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// hello main")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 总结:")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// CMD - SeaJS 只会在真正需要使用(依赖)模块时才执行该模块")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 虽 CMD 是异步加载模块形式, 但执行模块的顺序也是严格按照模块在代码中出现(require)的顺序")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 而 AMD - RequireJS 会先尽早地执行(依赖)模块, 相当于所有的 require 都被提前, 且模块执行的顺序也不一定 100% 按顺序执行")]),t._v("\n")])])])])]),t._v(" "),a("h5",{attrs:{id:"_1-2-7、阶段七-esmodule"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-7、阶段七-esmodule"}},[t._v("#")]),t._v(" 1-2-7、阶段七 EsModule")]),t._v(" "),a("p",[t._v("问题：前述阶段均未得到 JS 标准原生支持，均通过 JS函数模拟；并陆续有系列问题：")]),t._v(" "),a("ul",[a("li",[t._v("多个文件、管理混乱；\n"),a("ul",[a("li",[t._v("解决途径：拆分-require-commonJS；")])])]),t._v(" "),a("li",[t._v("浏览器异步，无法支持；\n"),a("ul",[a("li",[t._v("解决途径：AMD/CMD/UMD，最后有了ES6，这些是模块拆分，依赖管理，加载；")])])]),t._v(" "),a("li",[t._v("格式语法检查麻烦，转移麻烦、无法自动化测试、压缩麻烦，请求过多；\n"),a("ul",[a("li",[t._v("解决途径：模块打包，browserify、gulp、webpack；")])])])]),t._v(" "),a("p",[t._v("解决：ES6 新增模块系统，用 import、export 关键字来导入导出模块；模块加载与打包区别：")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("模块加载：更偏向于开发，解决变量管理、依赖管理问题；")]),t._v(" "),a("ul",[a("li",[t._v("如此可在浏览器端实现模块化开发(仍存问题：发起的 HTTP 请求随之增多、性能问题凸显)；")])])]),t._v(" "),a("li",[a("p",[t._v("模块打包：更偏向于生产、测试、自动化等末端问题；")]),t._v(" "),a("ul",[a("li",[t._v("指在模块化加载器处理的基础上，将入口文件打包，在打包过程中，让它去加载对应的依赖模块，最终生成的那份文件就是包含依赖模块的文件，以减少解析时加载依赖模块而增加的 http 请求；")])])])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// es module 已在 node9+ 支持，未支持的可通过 babel 或 typescript 使用")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// lib/greeting.js")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" helloTLP "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\ttest"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hello"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\tagain"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"TLP"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" greeting "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("sayHello")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("val")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("helloTLP")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("val"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// hello.js")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" greeting "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./lib/greeting'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" phrase "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" greeting"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sayHello")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'again'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ndocument"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("write")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("phrase"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h5",{attrs:{id:"_1-2-7-1、commonjs-与-esmodule-对比"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-7-1、commonjs-与-esmodule-对比"}},[t._v("#")]),t._v(" 1-2-7-1、CommonJs 与 EsModule 对比")]),t._v(" "),a("ul",[a("li",[t._v("前者模块是运行时加载，后者编译时输出接口；\n"),a("ul",[a("li",[t._v("前者加载的是一个对象(即"),a("code",[t._v("module.exports")]),t._v("属性)，该对象只有在脚本运行完才会生成；")]),t._v(" "),a("li",[t._v("后者模块不是对象，其对外接口只是一种静态定义，在代码静态解析阶段就会生成；")])])]),t._v(" "),a("li",[t._v("前者输出是值的拷贝；后者输出的是值的引用，被输出模块的内部的改变会影响引用的改变；")]),t._v(" "),a("li",[t._v("前者导入的模块路径可以是表达式/字符串，因其使用的是"),a("code",[t._v("require()")]),t._v("方法；而后者只能是字符串；")]),t._v(" "),a("li",[t._v("前者 "),a("code",[t._v("this")]),t._v("指向当前模块，后者 "),a("code",[t._v("this")]),t._v(" 指向 "),a("code",[t._v("undefined")]),t._v("；")]),t._v(" "),a("li",[t._v("前者包含顶层变量"),a("code",[t._v("arguments")]),t._v("、"),a("code",[t._v("require")]),t._v("、"),a("code",[t._v("module")]),t._v("、"),a("code",[t._v("exports")]),t._v("、"),a("code",[t._v("__filename")]),t._v("、"),a("code",[t._v("__dirname")]),t._v("，而后者没有；")])]),t._v(" "),a("h4",{attrs:{id:"_1-3、总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3、总结"}},[t._v("#")]),t._v(" 1-3、总结")]),t._v(" "),a("img",{staticStyle:{zoom:"50%"},attrs:{src:"/Image/Basics/Special/Engineering/12.png",align:"left"}}),t._v(" "),a("img",{staticStyle:{zoom:"50%"},attrs:{src:"/Image/Basics/Special/Engineering/18.png",align:"left"}}),t._v(" "),a("img",{staticStyle:{zoom:"50%"},attrs:{src:"/Image/Basics/Special/Engineering/14.png",align:"left"}}),t._v(" "),a("h5",{attrs:{id:"_1-3-1、commonjs"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-1、commonjs"}},[t._v("#")]),t._v(" 1-3-1、Commonjs")]),t._v(" "),a("h5",{attrs:{id:"_1-3-1-1、实现"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-1-1、实现"}},[t._v("#")]),t._v(" 1-3-1-1、实现")]),t._v(" "),a("ul",[a("li",[t._v("服务端：Node")]),t._v(" "),a("li",[t._v("浏览器：webpack、browserfy")])]),t._v(" "),a("h5",{attrs:{id:"_1-3-1-2、说明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-1-2、说明"}},[t._v("#")]),t._v(" 1-3-1-2、说明")]),t._v(" "),a("ul",[a("li",[a("p",[a("u",[t._v("采用同步方式加载模块，资源加载完再执行，用于服务端(硬盘读取速度快)；")])]),t._v(" "),a("ul",[a("li",[a("p",[t._v("服务端：模块加载时运行时同步加载；")])]),t._v(" "),a("li",[a("p",[t._v("浏览器：模块加载时提前编译打包处理；")])]),t._v(" "),a("li",[a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// cmjs.js")]),t._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'cmjs-module'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'3s later...'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    error"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'cmjs module output'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// test.js")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" cmjs "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./cmjs'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'here'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cmjs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// cmjs-module")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// here")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// undefined")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 3s later...")]),t._v("\n")])])])])])]),t._v(" "),a("li",[a("p",[t._v("代码均在模块作用域运行，不污染全局作用域；")])]),t._v(" "),a("li",[a("p",[t._v("模块在首次执行后就会缓存，再次加载只返回缓存结果，若想再次执行，可先清除缓存；")]),t._v(" "),a("ul",[a("li",[a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// cmjs.js")]),t._v("\nmodule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  name"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'TLP'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// test.js")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" m1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./0-cmjs'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nm1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'TSL'")]),t._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'m1: '")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" m1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" m2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./0-cmjs'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'m2: '")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" m2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// m1:  { name: 'TSL' }")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// m2:  { name: 'TSL' }")]),t._v("\n")])])])])])]),t._v(" "),a("li",[a("p",[t._v("输出是值的拷贝(即"),a("code",[t._v("require")]),t._v("返回的值，是被输出的值的拷贝(引用类型值会有影响，可利用作为闭包属性)，模块内部的变化也不会影响此输出值)；")]),t._v(" "),a("ul",[a("li",[a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// cmjs.js")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" name "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'TLP'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" array "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nmodule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  array\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  name "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'TLS'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  array"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// test.js")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" m1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./0-cmjs"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"m1: "')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" m1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2000s later m1: "')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" m1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// m1:  { name: 'TLP', array: [ 1, 2, 3 ] }")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 2000s later m1:  { name: 'TLP', array: [ 1, 2, 3, 4 ] }")]),t._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 闭包用途")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" counter "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("incCounter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  counter"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nmodule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("get")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("counter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" counter\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  incCounter"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" incCounter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])])])])]),t._v(" "),a("h5",{attrs:{id:"_1-3-1-3、基本语法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-1-3、基本语法"}},[t._v("#")]),t._v(" 1-3-1-3、基本语法")]),t._v(" "),a("h5",{attrs:{id:"_1-3-1-3-1、引入"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-1-3-1、引入"}},[t._v("#")]),t._v(" 1-3-1-3-1、引入")]),t._v(" "),a("ul",[a("li",[t._v("第三方引入："),a("code",[t._v("var fs = require('fs')")]),t._v(";")]),t._v(" "),a("li",[t._v("自动定义模块："),a("code",[t._v("require('./xx.jpg')")]),t._v("；")]),t._v(" "),a("li",[t._v("读入并执行一个 JS 文件，然后返回该模块的 exports 对象；若无发现指定模块则报错；")]),t._v(" "),a("li",[t._v("注意："),a("code",[t._v("require()")]),t._v(" 是 "),a("code",[t._v("Node.js")]),t._v("中的一个全局方法，window 环境并不存在，也并非 CommonJS 特有，CommonJS 只是众多规范中的其中一种；")])]),t._v(" "),a("h5",{attrs:{id:"_1-3-1-3-2、定义-暴露模块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-1-3-2、定义-暴露模块"}},[t._v("#")]),t._v(" 1-3-1-3-2、定义 & 暴露模块")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("module.exports = { name: xxx, age: yyy, ... } - 有效，但注意不等于 exports = { ... } // 无效")]),t._v("；")]),t._v(" "),a("li",[a("code",[t._v("exports.name = value 等同于 module.exports.name = value")]),t._v("；")]),t._v(" "),a("li",[a("code",[t._v("module")]),t._v(" 变量代表当前模块，此变量为一对象，其 "),a("code",[t._v("exports")]),t._v(" 属性是对外接口，即 exports 须与 module 搭配使用；")])]),t._v(" "),a("h5",{attrs:{id:"_1-3-1-3-3、其他-模块标识符"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-1-3-3、其他-模块标识符"}},[t._v("#")]),t._v(" 1-3-1-3-3、其他：模块标识符")]),t._v(" "),a("p",[t._v("模块标识符即在引入模块时调用 "),a("code",[t._v("require()")]),t._v(" 函数的参数；")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("// 直接导入\nconst path = require('path');\n// 相对路径\nconst TLP = require('./TLP.js');\n// 直接导入\nconst underscore = require('underscore');\n")])])]),a("p",[a("strong",[a("u",[t._v("模块有不同分类和与之相对应的查找方式：")])])]),t._v(" "),a("ul",[a("li",[a("p",[t._v("核心模块("),a("code",[t._v("Node.js")]),t._v("自带的模块，已二进制封装源码)：直接跳过路径分析和文件定位；")])]),t._v(" "),a("li",[a("p",[t._v("路径模块(寻找相对或绝对定位开始的模块)：直接得出相对路径；")])]),t._v(" "),a("li",[a("p",[t._v("自定义模块(寻找"),a("code",[t._v("node_modules")]),t._v("里的模块)：先在当前目录的 "),a("code",[t._v("node_modules")]),t._v(" 里寻找模块，若无则往上一级目录查找，查找上一级的"),a("code",[t._v("node_modules")]),t._v("，依次往上直到根目录，若还是没有则抛出错误；")])]),t._v(" "),a("li",[a("p",[t._v("注意："),a("strong",[a("u",[a("em",[t._v("路径分析")])])]),t._v("，即自定义模块的查找过程：可通过 module.paths 打印由当前目录到最上层目录的路径树：")]),t._v(" "),a("ul",[a("li",[a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("node "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("cache"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("js "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// console.log(module.paths)")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/Users/rjwx60/Documents/FE/Cache/node_modules'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/Users/rjwx60/Documents/FE/node_modules'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/Users/rjwx60/Documents/node_modules'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/Users/rjwx60/node_modules'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/Users/node_modules'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/node_modules'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])])])])]),t._v(" "),a("li",[a("p",[t._v("注意："),a("strong",[a("u",[a("em",[t._v("文件定位")])])]),t._v("，即导入的模块它的后缀(扩展名)可省略，Node 中省略了扩展名的文件，会自动依次补充上 .js, .node, .json 来尝试, 若传入的是一个目录，则 Node 会将其作为一个包来看待，并采用以下方式确定文件名：")]),t._v(" "),a("ul",[a("li",[t._v("首先，找出目录下的 package.json，用 JSON.parse()  解析出 main 字段；\n"),a("ul",[a("li",[t._v("若 main 字段指定的文件同样省略了扩展，则依次补充 .js, .node, .json 扩展名尝试；")]),t._v(" "),a("li",[t._v("若 main 字段制定的文件不存在，或根本就不存在 package.json，则默认依次尝试加载此目录下的 index.js, index.node, index.json文件；")])])])])])]),t._v(" "),a("h5",{attrs:{id:"_1-3-2、amd"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-2、amd"}},[t._v("#")]),t._v(" 1-3-2、AMD")]),t._v(" "),a("h5",{attrs:{id:"_1-3-2-1、实现"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-2-1、实现"}},[t._v("#")]),t._v(" 1-3-2-1、实现")]),t._v(" "),a("ul",[a("li",[t._v("浏览器：require.js")])]),t._v(" "),a("h5",{attrs:{id:"_1-3-2-2、说明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-2-2、说明"}},[t._v("#")]),t._v(" 1-3-2-2、说明")]),t._v(" "),a("ul",[a("li",[a("u",[t._v("采用异步方式加载模块，指定回调函数，用于浏览器(网络延迟决定异步方式)；")])]),t._v(" "),a("li",[t._v("依赖必须提前声明好；")])]),t._v(" "),a("h5",{attrs:{id:"_1-3-2-3、基本语法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-2-3、基本语法"}},[t._v("#")]),t._v(" 1-3-2-3、基本语法")]),t._v(" "),a("h5",{attrs:{id:"_1-3-2-3-1、引入"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-2-3-1、引入"}},[t._v("#")]),t._v(" 1-3-2-3-1、引入")]),t._v(" "),a("p",[a("code",[t._v("require(['module1', 'module2'], function(m1, m2) { use m1 & m2} )")]),t._v("；")]),t._v(" "),a("h5",{attrs:{id:"_1-3-2-3-2、定义-暴露模块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-2-3-2、定义-暴露模块"}},[t._v("#")]),t._v(" 1-3-2-3-2、定义 & 暴露模块")]),t._v(" "),a("ul",[a("li",[t._v("无依赖："),a("code",[t._v("define(function() { return module })")]),t._v("；")]),t._v(" "),a("li",[t._v("有依赖："),a("code",[t._v("define(['module1', 'module2'], function(m1, m2) { return module })")])])]),t._v(" "),a("h5",{attrs:{id:"_1-3-3、cmd"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-3、cmd"}},[t._v("#")]),t._v(" 1-3-3、CMD")]),t._v(" "),a("h5",{attrs:{id:"_1-3-3-1、实现"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-3-1、实现"}},[t._v("#")]),t._v(" 1-3-3-1、实现")]),t._v(" "),a("ul",[a("li",[t._v("浏览器：sea.js")])]),t._v(" "),a("h5",{attrs:{id:"_1-3-3-2、说明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-3-2、说明"}},[t._v("#")]),t._v(" 1-3-3-2、说明")]),t._v(" "),a("ul",[a("li",[a("u",[t._v("模块加载异步，模块使用时才会加载执行")]),t._v("；")]),t._v(" "),a("li",[t._v("模块使用时再声明；")]),t._v(" "),a("li",[t._v("整合 commonJs 与 AMD 特点；")])]),t._v(" "),a("h5",{attrs:{id:"_1-3-3-3、基本语法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-3-3、基本语法"}},[t._v("#")]),t._v(" 1-3-3-3、基本语法")]),t._v(" "),a("h5",{attrs:{id:"_1-3-3-3-1、引入"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-3-3-1、引入"}},[t._v("#")]),t._v(" 1-3-3-3-1、引入")]),t._v(" "),a("ul",[a("li",[t._v("同步："),a("code",[t._v("var fs = require('fs')")]),t._v("；")]),t._v(" "),a("li",[t._v("异步："),a("code",[t._v("require.async('./module3', function(m3){ //... })")]),t._v("；")])]),t._v(" "),a("h5",{attrs:{id:"_1-3-3-3-2、定义-暴露模块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-3-3-2、定义-暴露模块"}},[t._v("#")]),t._v(" 1-3-3-3-2、定义 & 暴露模块")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("无依赖：")]),t._v(" "),a("ul",[a("li",[a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("define")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("require"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" exports"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" module")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  exports"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("xxx "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])])])]),t._v(" "),a("li",[a("p",[t._v("有依赖：")]),t._v(" "),a("ul",[a("li",[a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("define")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("require"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" exports"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" module")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 引入依赖模块(同步)")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" module2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./module2'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 引入依赖模块(异步)")]),t._v("\n  require"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("async")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./module3'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("m3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 暴露")]),t._v("\n  exports"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("xxx "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])])])])]),t._v(" "),a("h5",{attrs:{id:"_1-3-4、esmodule"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-4、esmodule"}},[t._v("#")]),t._v(" 1-3-4、EsModule")]),t._v(" "),a("h5",{attrs:{id:"_1-3-4-1、实现"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-4-1、实现"}},[t._v("#")]),t._v(" 1-3-4-1、实现")]),t._v(" "),a("ul",[a("li",[t._v("服务端与浏览器端通用；")]),t._v(" "),a("li",[t._v("浏览器端：目前需要使用 Babel 将 ES6 转译 ES5 或利用 Browserify 编译；")])]),t._v(" "),a("h5",{attrs:{id:"_1-3-4-2、说明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-4-2、说明"}},[t._v("#")]),t._v(" 1-3-4-2、说明")]),t._v(" "),a("ul",[a("li",[t._v("输出使用"),a("code",[t._v("export")]),t._v("、输入使用"),a("code",[t._v("import")])]),t._v(" "),a("li",[t._v("可使用 "),a("code",[t._v("export...from...")]),t._v(" 写法来达到一个 "),a("code",[t._v('"中转"')]),t._v(" 的效果；")]),t._v(" "),a("li",[t._v("输入的模块变量是不可重新赋值，它只是个可读引用，但可改写属性；")]),t._v(" "),a("li",[a("code",[t._v("import")]),t._v(" 命令具有提升效果，会提升到整个模块的头部，首先执行；")]),t._v(" "),a("li",[a("code",[t._v("export")]),t._v(" 和 "),a("code",[t._v("import")]),t._v(" 命令可出现在模块的任何位置，只要处于模块顶层就可以；但若处于块级作用域内就会报错，因处于条件代码块中无法做静态优化，违背了ES6模块的设计初衷；")])]),t._v(" "),a("h5",{attrs:{id:"_1-3-4-3、基本语法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-4-3、基本语法"}},[t._v("#")]),t._v(" 1-3-4-3、基本语法")]),t._v(" "),a("h5",{attrs:{id:"_1-3-4-3-1、引入"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-4-3-1、引入"}},[t._v("#")]),t._v(" 1-3-4-3-1、引入")]),t._v(" "),a("p",[t._v("import 有两种模块导入方式：")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("命名式导入(名称导入)")])]),t._v(" "),a("li",[a("p",[t._v("默认导入(定义式导入)")])]),t._v(" "),a("li",[a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 某个模块的导出 moudule.js")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" a "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 模块导入")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 1. 这里的a得和被加载的模块输出的接口名对应")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" a "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./module'")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 2. 使用 as 换名")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" a "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" myA "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./module'")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 3. 若是只想要运行被加载的模块可以这样写，但是即使加载2次也只是运行一次")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./module'")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 4. 整体加载")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" module "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./module'")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 5. default接口和具名接口")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" a "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./module'")]),t._v("\n")])])])])]),t._v(" "),a("h5",{attrs:{id:"_1-3-4-3-2、定义-暴露模块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-4-3-2、定义-暴露模块"}},[t._v("#")]),t._v(" 1-3-4-3-2、定义 & 暴露模块")]),t._v(" "),a("p",[t._v("export 有两种模块导出方式：")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("命名式导出(名称导出)："),a("code",[t._v("export Module")]),t._v("；")]),t._v(" "),a("ul",[a("li",[a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 以下两种为错误")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 1.")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 2.")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" a "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 以下为正确")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 3.")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" a "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" a "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 4. 接口名与模块内部变量之间，建立了一一对应的关系")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" a "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" b "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 5. 接口名与模块内部变量之间，建立了一一对应的关系")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" a "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" b "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 或者用 as 来命名")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" a "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" a "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" outA "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" a "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" b "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" a "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" outA"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" b "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" outB "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])])])]),t._v(" "),a("li",[a("p",[t._v("默认导出(自定义导出)："),a("code",[t._v("export default Module")])]),t._v(" "),a("ul",[a("li",[a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 1.")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" a "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 2.")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" a "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" a "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 3.")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 可以导出一个函数")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 也可以出一个类")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 4.")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" a "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" defalut a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 等价于")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" a "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])])])])]),t._v(" "),a("h5",{attrs:{id:"_1-3-5、es6-与-commonjs-对比"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-5、es6-与-commonjs-对比"}},[t._v("#")]),t._v(" 1-3-5、ES6 与 Commonjs 对比")]),t._v(" "),a("ul",[a("li",[t._v("输出值：\n"),a("ul",[a("li",[t._v("ES6 输出的是值引用：\n"),a("ul",[a("li",[t._v("ES6 模块是动态引用，且不会缓存值，模块中的变量绑定其所在的模块；")])])]),t._v(" "),a("li",[t._v("Commonjs 输出的是值拷贝；\n"),a("ul",[a("li",[t._v("模块可多次加载，但只在首次加载时运行一次，并缓存运行结果；后续加载时则直接读取缓存值，若要让模块再次运行，则须清除缓存；")])])])])]),t._v(" "),a("li",[t._v("加载方式：\n"),a("ul",[a("li",[t._v("ES6 编译时输出接口：\n"),a("ul",[a("li",[t._v("ES6 模块不是对象，其对外接口只是一种静态定义，在的代码静态解析阶段即生成；")])])]),t._v(" "),a("li",[t._v("Commonjs 运行时加载：\n"),a("ul",[a("li",[t._v("因 Commonjs 加载的是一个对象(即 module.exports 属性)，该对象只有在脚本运行时才会生成；")])])])])])]),t._v(" "),a("h5",{attrs:{id:"_1-3-6、require-与-import-对比"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-6、require-与-import-对比"}},[t._v("#")]),t._v(" 1-3-6、require 与 import 对比")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("前者 "),a("u",[t._v("支持动态导入")]),t._v("，后者不支持，正在提案 (babel 下可支持)；")])]),t._v(" "),a("li",[a("p",[t._v("前者 属于 "),a("u",[t._v("同步导入")]),t._v("，后者属于 "),a("u",[t._v("异步导入")]),t._v("；")])]),t._v(" "),a("li",[a("p",[t._v("前者是 "),a("u",[t._v("值拷贝")]),t._v("，导出值变化不会影响导入值；后者 "),a("u",[t._v("引用拷贝")]),t._v("，指向内存，导入值会随导出值而变化；")])]),t._v(" "),a("li",[a("p",[t._v("注意：export/import 在 Babel 下的转换使用，正因 Babel 这种转换，才可以将 "),a("code",[t._v("exports")]),t._v(" 和 "),a("code",[t._v("import")]),t._v(" 结合起来用；")])]),t._v(" "),a("li",[a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 1、Babel 编译结果")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Output")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" count "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Input")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("count"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./m1.js'")]),t._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("count"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Babel Output")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"use strict"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nObject"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("defineProperty")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("exports"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"__esModule"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  value"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nexports"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("count "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" count "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nexports"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("count "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" count"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Babel Iutput")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"use strict"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" _m "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./m1.js"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("_m"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("count"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 2、因为 Babel 的存在，所以可以风格迥异的使用: exports 和 import")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// OutPut")]),t._v("\nexports"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("count "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Input")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("count"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./m1.js'")]),t._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("count"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])])]),t._v(" "),a("h5",{attrs:{id:"_1-3-7、综合对比"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-7、综合对比"}},[t._v("#")]),t._v(" 1-3-7、综合对比")]),t._v(" "),a("img",{staticStyle:{zoom:"45%"},attrs:{src:"/Image/Basics/Special/Engineering/16.png",align:"left"}}),t._v(" "),a("h4",{attrs:{id:"_1-4、未来"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-4、未来"}},[t._v("#")]),t._v(" 1-4、未来")]),t._v(" "),a("p",[t._v("观点1：随复杂而变化；")]),t._v(" "),a("p",[t._v("09年前，前端模块化探索都是基于语言层面的优化，09年后，随着 CommonJS 的引入，前端才开始采用服务端的解决方案，大量使用预编译，为何模块化方案如此晚成型，是因为前期应用复杂度在后端，但随着 Ajax 的火起，webApp 的流行，前端复杂度呈指数级上升；")]),t._v(" "),a("p",[t._v("观点2：原生支持的模块化，解决 html 与 css 模块化问题正是以后的方向；")]),t._v(" "),a("p",[t._v("未来 css 模块化，将是运行时的，比如不依赖预编译的方式是 "),a("code",[t._v("styled-component")]),t._v("；")]),t._v(" "),a("p",[t._v("未来 html 模块化，将会得到浏览器，编辑器的模块化支持，还可能会取代 jsx 成为最强大的模块化、模板语言；")]),t._v(" "),a("p",[t._v("未来 js 模块化，将会是 "),a("code",[t._v('<script type="module">')]),t._v(" 的形式，并配合 HTTP2.0 完美抛开预编译枷锁；")]),t._v(" "),a("p",[t._v("观点3：模块化标准推进进度缓慢；")]),t._v(" "),a("p",[t._v("ES2015 Modules 解决了开发的问题，由于浏览器的特殊性，还是要经过繁琐打包的过程，只有当 Import，Export 和 HTTP 2.0 被主流浏览器支持，才是彻底的模块化；而 HTTP2.0 后，也会不断地有新技术出现，仍需使用配套工具将问题解决方案推向极致；")]),t._v(" "),a("p",[t._v("观点4：模块化后还存在一个模块间耦合问题，若模块间耦合度大也会降低代码的可重用性或者说复用性；")]),t._v(" "),a("p",[t._v("所以也出现了降低耦合的观察者模式或者发布/订阅模式；这对于提升代码重用，复用性和避免单点故障等都很重要；")]),t._v(" "),a("p",[t._v("响应式编程（RxJS），核心概念就是 observable，也就是 Rx 中的流（stream），其可以被 subscribe，其实也就是观察者设计模式；")]),t._v(" "),a("h3",{attrs:{id:"二、模块构建工具"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、模块构建工具"}},[t._v("#")]),t._v(" 二、模块构建工具")]),t._v(" "),a("p",[t._v("模块化规范：规范如何组织代码，提高代码可读性，用以针对开发者；")]),t._v(" "),a("p",[t._v("包管理工具：用以管理包的安装、卸载、更新、查看、搜索、发布等；")]),t._v(" "),a("p",[t._v("模块化构建工具：用以组织前端模块逻辑的构建工具、现已不局限于模块化，还有很多便利的工具，如压缩、代码检查等；")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"center"}},[a("strong",[t._v("包管理工具")])]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[a("strong",[t._v("模块化构建工具")])]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[a("strong",[t._v("模块化规范")])])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("npm")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("webpack")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("es6Module")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("bower")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("requireJs、seaJs、browserify")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("AMD、CMD、UMD、CommonJS")])])])]),t._v(" "),a("h4",{attrs:{id:"_2-1、模块构建工具演变"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1、模块构建工具演变"}},[t._v("#")]),t._v(" 2-1、模块构建工具演变")]),t._v(" "),a("img",{staticStyle:{zoom:"50%"},attrs:{src:"/Image/Basics/Special/Engineering/13.png",align:"left"}}),t._v(" "),a("ul",[a("li",[t._v("黑暗时代、构建、通过在线工具压缩和混淆(避免代码逻辑暴露)、08年出现 YUI(可本地进行JSCSS压缩)")]),t._v(" "),a("li",[t._v("模块化推进、并催生各种规范；")]),t._v(" "),a("li",[t._v("Grunt：Task Runner，将构建过程分为多个独立任务、任务处理完成后将结果存放到本地磁盘中，导致打包速度慢(涉及磁盘IO操作)")]),t._v(" "),a("li",[t._v("Gulp、FIS3：改进前者；引入文件流概念，将处理结果存放内存中，下一任务可直接利用前一步处理结果，加速打包速度；\n"),a("ul",[a("li",[t._v("注意 FIS3 已不再维护；")])])]),t._v(" "),a("li",[t._v("Webpack：社区活跃、官方更迭速度快、配置灵活插件化扩展；\n"),a("ul",[a("li",[t._v("Rollup：主要引入了 tree-shaking 概念；")])])])]),t._v(" "),a("img",{staticStyle:{zoom:"50%"},attrs:{src:"/Image/Basics/Special/Engineering/17.png",align:"left"}}),t._v(" "),a("h4",{attrs:{id:"_2-2、模块工具简介"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2、模块工具简介"}},[t._v("#")]),t._v(" 2-2、模块工具简介")]),t._v(" "),a("h5",{attrs:{id:"_2-2-1、browserify"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-1、browserify"}},[t._v("#")]),t._v(" 2-2-1、Browserify")]),t._v(" "),a("p",[t._v("Commonjs In Browser - 2011 - 2014 - 模块打包器")]),t._v(" "),a("p",[t._v("原理：其找出入口文件，解析 require-调用为 AST，以遍历项目的整个依赖关系，并将其所有依赖项都包含在出口文件中；")]),t._v(" "),a("p",[t._v("使用："),a("code",[t._v("browserify main.js -o bundle.js")])]),t._v(" "),a("ul",[a("li",[t._v("注意：browserify 是 模块打包器，browserify 是在浏览器中利用 CommonJS 的思想实现；")])]),t._v(" "),a("h5",{attrs:{id:"_2-2-2、webpack"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-2、webpack"}},[t._v("#")]),t._v(" 2-2-2、Webpack")]),t._v(" "),a("p",[t._v("Module Bundler - 2014 - 模块打包器")]),t._v(" "),a("p",[t._v("基本：Webpack 始于 2012 年，由 Tobias Koppers 发起，⽤于解决当时前端开发的⼀个难题：构建复杂的单⻚ 应⽤程序(SPA)；Webpack 将⼀切都作为模块，然后通过不同加载器 loader 来加载这些模块；若想按需加载，则其还提供了代码拆分 (Code Splitting)")]),t._v(" "),a("p",[t._v("介绍：可处理 CommonJS 、 AMD 和 ES6 模块，并具有多种功能：")]),t._v(" "),a("ul",[a("li",[t._v("loader：加载器，可加载任何文件到源文件中；用 require() 语法，可加载 Js、CSS、CoffeeScript、Sass、Less、HTML模板、图像等；")]),t._v(" "),a("li",[t._v("plugin：可在打包写入到打包文件之前对其进行操作；比如，给打包代码添加注释，添加 Source map，将打包文件分离成块等等；")]),t._v(" "),a("li",[t._v("tree-shaking：webpack2 引入： "),a("a",{attrs:{href:"https://www.html.cn/archives/6946",target:"_blank",rel:"noopener noreferrer"}},[t._v("webpack 2 中的 Tree Shaking"),a("OutboundLink")],1),t._v("，更多 tree-shaking 内容请看 rollup 小节")]),t._v(" "),a("li",[t._v("dev-server：热更新开发；")]),t._v(" "),a("li",[t._v("code-splitting：代码拆分；")])]),t._v(" "),a("h5",{attrs:{id:"_2-2-2-1、version-diff"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-2-1、version-diff"}},[t._v("#")]),t._v(" 2-2-2-1、Version diff")]),t._v(" "),a("p",[t._v("不管哪个版本，"),a("strong",[a("u",[a("em",[t._v("均能节省前端程序员时间")])])]),t._v("：")]),t._v(" "),a("p",[t._v("Webpack 1 发布：")]),t._v(" "),a("ul",[a("li",[t._v("模块加载、代码拆分；")])]),t._v(" "),a("p",[t._v("Webpack 2 发布：")]),t._v(" "),a("ul",[a("li",[t._v("增加 tree-shaking (借鉴 Rollup)；")])]),t._v(" "),a("p",[t._v("Webpack 3 发布：")]),t._v(" "),a("ul",[a("li",[t._v("增加 Scope Hoisting (借鉴 Rollup)；")])]),t._v(" "),a("p",[t._v("Webpack 4 发布：")]),t._v(" "),a("ul",[a("li",[t._v("免配置；\n"),a("ul",[a("li",[t._v("⽐如默认 entry 为 ./src，默认 output  为 ./dist，即项目初始时不用配置 webpack.config (借鉴 Parcel)")]),t._v(" "),a("li",[a("img",{staticStyle:{zoom:"25%"},attrs:{src:"/Image/Basics/Special/Engineering/20.png",align:"left"}})])])]),t._v(" "),a("li",[a("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/32691352",target:"_blank",rel:"noopener noreferrer"}},[t._v("支持 JSON 的 tree-shaking"),a("OutboundLink")],1),t._v("；")]),t._v(" "),a("li",[t._v("支持 .mjs (EcmaScript module)；")]),t._v(" "),a("li",[t._v("支持 WebAssembly，默认会寻找 .wasm , .mjs , .js 和 .json 扩展名的⽂件进⾏加载和打包；")]),t._v(" "),a("li",[t._v("优化提升，删除了 CommonsChunkPlugin，增加了 optimization.splitChunks 和 optimization.runtimeChunk；\n"),a("ul",[a("li",[t._v("CommonsChunkPlugin 存在 hash 问题，使用复杂，虽改造后仍复杂；")])])]),t._v(" "),a("li",[t._v("代码层面的最大变化：整个 Plugin 的事件注册与触发机制被重写，所有三方插件都要修改才能使用：")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Webpack3 注册 与 触发")]),t._v("\ncompiler"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("plugin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("‘done’"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("callback"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ncompilitation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("applyPlugins")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("‘done’"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("params"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Webpack4 注册 与 触发")]),t._v("\ncompiler"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("hooks"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("done"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("tap")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("‘mypluinname’"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("callback"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ncompiler"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("hooks"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("done")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("call")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("h5",{attrs:{id:"_2-2-3、systemjs"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-3、systemjs"}},[t._v("#")]),t._v(" 2-2-3、SystemJS")]),t._v(" "),a("p",[t._v("通用模块加载器，能在浏览器 / Node 上动态加载模块、支持 CommonJS、AMD、全局模块对象和 ES6 模块；通过插件，可加载 Js、CoffeeScript、TypeScript；")]),t._v(" "),a("p",[t._v("优点：建立在 ES6 模块加载器之上，其语法 & API 在将来很可能是语言的一部分；")]),t._v(" "),a("h5",{attrs:{id:"_2-2-x、rollup"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-x、rollup"}},[t._v("#")]),t._v(" 2-2-X、Rollup")]),t._v(" "),a("p",[t._v("普及 JS 圈内一重要特性：Tree shaking，即消除 JS 上下文中无用代码，只保留有用的代码；")]),t._v(" "),a("p",[t._v("原理：依赖于 ES6 模块 import / export 模块系统的静态结构(static structure) 来检测哪一模块没有被使用；")]),t._v(" "),a("h5",{attrs:{id:"_2-2-x-1、tree-shaking"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-x-1、tree-shaking"}},[t._v("#")]),t._v(" 2-2-X-1、Tree-shaking")]),t._v(" "),a("p",[a("u",[t._v("注意：讨论的此版本为 2018年1月的 webpack 版本的 TreeShaking，webpack4 已无下述问题；")])]),t._v(" "),a("p",[t._v("背景："),a("strong",[a("u",[a("em",[t._v("Tree-shaking")])])]),t._v(" 最早由 Rich Harris 的 rollup 实现，后来支持此功能的还有 webpack2、"),a("strong",[a("u",[a("em",[t._v("Closure compiler")])])])]),t._v(" "),a("p",[t._v("定义：通过工具去除 JS  文件中没有使用到的代码或模块，以删除无用代码，实现性能优化；")]),t._v(" "),a("p",[t._v("意义：Tree-shaking 对 web 意义重大，是一极致优化的理想世界，是前端进化的又一个终极理想；")]),t._v(" "),a("h5",{attrs:{id:"_2-2-x-2、dce"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-x-2、dce"}},[t._v("#")]),t._v(" 2-2-X-2、DCE")]),t._v(" "),a("p",[a("strong",[a("u",[a("em",[t._v("DCE—dead code elimination")])])]),t._v("，消除无用代码；无用代码消除广泛存在于传统的编程语言编译器中，编译器可判断出哪些代码根本不影响输出，从而消除此部分代码，此称为 DCE，而 Tree-shaking 是 DCE 的新实现；")]),t._v(" "),a("ul",[a("li",[t._v("JS 绝大多数情况都需通过网络加载，然后执行，加载文件越小，整体执行时间越短，故消除无用代码减少体积对 JS 非常有意义；")]),t._v(" "),a("li",[t._v("JS DCE—Tree-shaking 与 传统 DCE 不一样，后者消除不可能执行的代码，前者关注于去除没有用到的代码；")])]),t._v(" "),a("h5",{attrs:{id:"_2-2-x-2-1、tree-shaking"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-x-2-1、tree-shaking"}},[t._v("#")]),t._v(" 2-2-X-2-1、Tree-Shaking")]),t._v(" "),a("p",[a("u",[t._v("DeadCode")]),t._v(" 几个特征：")]),t._v(" "),a("ul",[a("li",[t._v("代码不会被执行，不可到达；")]),t._v(" "),a("li",[t._v("代码执行结果不会被用到；")]),t._v(" "),a("li",[t._v("代码只影响死变量(只写不读)；")]),t._v(" "),a("li",[a("img",{staticStyle:{zoom:"60%"},attrs:{src:"/Image/Basics/Special/Engineering/21.png",align:"left"}})])]),t._v(" "),a("p",[t._v("传统编译型的语言中，均由编译器将 "),a("u",[t._v("Dead Code")]),t._v(" 从 AST 中删除；")]),t._v(" "),a("p",[t._v("而 JS 中 DCE 是由代码压缩优化工具 uglify 完成；")]),t._v(" "),a("ul",[a("li",[t._v("示例：均未增加 uglify 处理、未进行 DCE 的 rollup 和 webpack：\n"),a("ul",[a("li",[t._v("现象：rollup 将无用代码 foo 和 unused 函数消除，但仍保留了不会执行到的代码，而 webpack 完整保留所有代码；")]),t._v(" "),a("li",[a("img",{staticStyle:{zoom:"60%"},attrs:{src:"/Image/Basics/Special/Engineering/22.png",align:"left"}})])])]),t._v(" "),a("li",[t._v("示例：增加 uglify 处理、进行了 DCE 的 rollup 和 webpack：\n"),a("ul",[a("li",[t._v("现象：中间是两者增加 uglify 的配置文件，右侧是两者输出结果：")]),t._v(" "),a("li",[a("img",{staticStyle:{zoom:"60%"},attrs:{src:"/Image/Basics/Special/Engineering/23.png",align:"left"}})])])])]),t._v(" "),a("h5",{attrs:{id:"_2-2-x-2-2、tree-shaking-原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-x-2-2、tree-shaking-原理"}},[t._v("#")]),t._v(" 2-2-X-2-2、Tree-Shaking 原理")]),t._v(" "),a("p",[a("u",[a("em",[a("strong",[t._v("Tree-shaking 的消除原理依赖于 ES6 的模块特性，即要使用 ES6 module syntax 才可 Tree-shaking")])])]),t._v("；其特点：")]),t._v(" "),a("ul",[a("li",[t._v("仅能作为模块顶层的语句出现；")]),t._v(" "),a("li",[t._v("import 的模块名只能是字符串变量；")]),t._v(" "),a("li",[t._v("import binding 是 immutable 的；")])]),t._v(" "),a("p",[t._v("ES6 模块依赖关系是确定的、与运行时的状态无关，可进行可靠的静态分析，此亦乃 Tree-shaking 实现基础：")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("静态分析：即不执行代码，从字面量对代码进行分析；")])]),t._v(" "),a("li",[a("p",[t._v("比如：反例：ES6 前的模块化方案：动态 require 某模块时，只有执行后才知道引用了什么模块；")])]),t._v(" "),a("li",[a("p",[t._v("函数的 tree-shaking 验证：去除无用函数")]),t._v(" "),a("ul",[a("li",[t._v("现象：rollup 与 webpack 操作的结果均无无用函数 get，很好；")]),t._v(" "),a("li",[a("img",{staticStyle:{zoom:"60%"},attrs:{src:"/Image/Basics/Special/Engineering/24.png",align:"left"}})])])]),t._v(" "),a("li",[a("p",[t._v("类的 tree-shaking 验证：去除无用类")]),t._v(" "),a("ul",[a("li",[t._v("现象：rollup 与 webpack 操作的结果均包含了无用类的整体代码...；")]),t._v(" "),a("li",[a("img",{staticStyle:{zoom:"60%"},attrs:{src:"/Image/Basics/Special/Engineering/25.png",align:"left"}})])])]),t._v(" "),a("li",[a("p",[t._v("原因：")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("rollup 只能处理函数和顶层的 import/export 变量，无法将无用到的类方法去除；")])]),t._v(" "),a("li",[a("p",[t._v("js 动态语言的特性使得静态分析艰难；")])]),t._v(" "),a("li",[a("p",[t._v("SideEffect(副作用) 广泛存在(无法判断真正有用无用代码，删除有效代码)")]),t._v(" "),a("ul",[a("li",[a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// SideEffect")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Ex1")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Menu")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Menu")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prototype"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("show")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Array 扩展")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Array")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prototype"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("unique")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 将 array 中的重复元素去除")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" Menu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 若删除 menu.js，则对 Array 扩展也会被删除，就会影响功能")]),t._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Ex2")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Menu")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Menu")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prototype"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("show")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" a "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Arr'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ay'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" b\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("a "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Array'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    b "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Array\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    b "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Menu\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prototype"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("unique")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 将 array 中的重复元素去除")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" Menu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])])])])])]),t._v(" "),a("li",[a("p",[t._v("总结：Tree-shaking 对顶层纯函数的效果好，其余处理效果不佳；")]),t._v(" "),a("ul",[a("li",[t._v("函数的 SideEffect 相对较少、顶层函数相对更容易分析、而 babel 默认严格模式，减少顶层函数的动态访问方式也更容易分析；")])])])]),t._v(" "),a("h5",{attrs:{id:"_2-2-x-2-3、closure-compiler"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-x-2-3、closure-compiler"}},[t._v("#")]),t._v(" 2-2-X-2-3、Closure compiler")]),t._v(" "),a("img",{staticStyle:{zoom:"60%"},attrs:{src:"/Image/Basics/Special/Engineering/26.png",align:"left"}}),t._v(" "),a("p",[t._v("现象：完美实现 Tree Shaking；")]),t._v(" "),a("p",[t._v("注意：完美结果是需要条件的，那就是 cc 的侵入式约束规范；必须在代码里添加这样的代码；")]),t._v(" "),a("img",{staticStyle:{zoom:"60%"},attrs:{src:"/Image/Basics/Special/Engineering/27.png",align:"left"}}),t._v(" "),a("p",[t._v("总结：Google 定义一整套注解规范 "),a("u",[a("em",[t._v("Annotating JavaScript for the Closure Compiler")])]),t._v("，侵入式让人不爽，且 Google Closure Compiler 是 java 写的，而与基于 node 的各种构建库不太兼容(目前已有 nodejs 版 Closure Compiler)，Closure Compiler 使用较麻烦，迁移成本较大；")]),t._v(" "),a("h5",{attrs:{id:"_2-2-y、构建工具的选择"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-y、构建工具的选择"}},[t._v("#")]),t._v(" 2-2-Y、构建工具的选择")]),t._v(" "),a("img",{staticStyle:{zoom:"40%"},attrs:{src:"/Image/Basics/Special/Engineering/28.png",align:"left"}}),t._v(" "),a("p",[t._v("Webpack 和 Rollup 在不同场景下，都能发挥自身优势作用；")]),t._v(" "),a("ul",[a("li",[t._v("webpack 作为打包工具，但是在定义模块输出的时候，webpack确不支持ESM，webpack插件系统庞大，确实有支持模块级的 Tree-Shacking 的插件，如webpack-deep-scope-analysis-plugin；")]),t._v(" "),a("li",[t._v("rollup 支持程序流分析，能更加正确的判断项目本身的代码是否有副作用，其实就是 rollup 的 tree-shaking 更干净；")]),t._v(" "),a("li",[t._v("结论：rollup 比较适合打包 js 的 sdk 或者封装的框架等，例如，vue 源码就是 rollup 打包的；而 webpack 较适合打包一些应用，例如 SPA 或同构项目等；")])]),t._v(" "),a("h3",{attrs:{id:"x、大厂开发与部署代码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#x、大厂开发与部署代码"}},[t._v("#")]),t._v(" X、大厂开发与部署代码")]),t._v(" "),a("h4",{attrs:{id:"x-1、阿里流程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#x-1、阿里流程"}},[t._v("#")]),t._v(" X-1、"),a("a",{attrs:{href:"https://juejin.im/post/6844904192201654279",target:"_blank",rel:"noopener noreferrer"}},[t._v("阿里流程"),a("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=e.exports}}]);