(window.webpackJsonp=window.webpackJsonp||[]).push([[197],{522:function(_,v,t){"use strict";t.r(v);var a=t(4),e=Object(a.a)({},(function(){var _=this,v=_.$createElement,t=_._self._c||v;return t("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[t("h1",{attrs:{id:"一、osi-七层模型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一、osi-七层模型"}},[_._v("#")]),_._v(" 一、OSI 七层模型")]),_._v(" "),t("p",[_._v("即应用层、表示层、会话层、传输层、网络层、数据链路层、物理层")]),_._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[_._v("application layer、presentation layer、session layer、transport layer、network layer、data link layer、physical layer\n")])])]),t("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://leibnize-picbed.oss-cn-shenzhen.aliyuncs.com/img/20200908000056.png"}}),_._v(" "),t("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://leibnize-picbed.oss-cn-shenzhen.aliyuncs.com/img/20200908000113.png"}}),_._v(" "),t("h1",{attrs:{id:"二、cdn"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#二、cdn"}},[_._v("#")]),_._v(" 二、CDN")]),_._v(" "),t("p",[_._v("为突破现实生活中的光速、传输距离等物理限制，CDN 投入了大量资金，在全球范围内各大枢纽城市建立机房，部署大量高存储高带宽的节点，构建跨运营商、跨地域的专用高速传输网络；其中分为中心节点、区域节点、边缘节点等，在用户接入网络后，首先通过全局负载均衡 "),t("code",[_._v("(Global Sever Load Balance)")]),_._v("，简称 GSLB 算法负责调度，找到离用户最合适的节点。然后通过 HTTP 缓存代理技术进行缓存，缓存命中就返回给用户，否则就回源站去取。CDN 擅长缓存静态资源(图片、音频等)，当然也支持动态内容的缓存；")]),_._v(" "),t("h2",{attrs:{id:"_2-1、基本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1、基本"}},[_._v("#")]),_._v(" 2-1、基本")]),_._v(" "),t("p",[_._v("CDN 全称：Content Delivery Network，即内容分发网络；CDN 是构建在现有网络基础之上的智能虚拟网络，依靠部署在各地的边缘服务器，通过中心平台的负载均衡、内容分发、调度等功能模块，使用户就近获取所需内容，降低网络拥塞，提高用户访问响应速度和命中率；")]),_._v(" "),t("p",[_._v("CDN 原理：将源站的资源缓存岛位于全球各地的 CDN 节点上，用户请求资源时，就近返回节点上缓存的资源，而不需要每个用户的请求都从您的源站获取，避免网络拥塞、缓解源站压力，保证用户访问资源的速度和体验；")]),_._v(" "),t("p",[_._v("CDN 关键：内容存储和分发技术；")]),_._v(" "),t("p",[_._v('CDN 作用：减少传播时延，寻找到最近的节点，是典型的"以空间换时间"技术；')]),_._v(" "),t("ul",[t("li",[_._v("比如：淘宝网站的资源大部分都部署到CDN节点上；")]),_._v(" "),t("li",[_._v("比如：某网站服务器全部署在一个地方，那么全国各地访问均集中到这里访问，但因每地访问此处时的延时不同，且源站容易负载过大挂掉； 解决方案使用 CDN，在全国各地多个区域中心部署 CDN 节点，使各地用户可就近访问，有效减少传播时延，并且大大降低源站的负载；")])]),_._v(" "),t("p",[_._v("CDN 优点：")]),_._v(" "),t("ul",[t("li",[_._v("解决服务端的第一公里的问题")]),_._v(" "),t("li",[_._v("缓解甚至消除不同运营商之间互联的瓶颈造成的影响")]),_._v(" "),t("li",[_._v("减轻了各省的出口带宽压力")]),_._v(" "),t("li",[_._v("缓解了骨干网的压力")]),_._v(" "),t("li",[_._v("优化了网上热点内容")])]),_._v(" "),t("p",[_._v("CDN 组成：")]),_._v(" "),t("ul",[t("li",[t("p",[_._v("智能调度 DNS：CDN服务中的关键系统，当用户访问加入 CDN 服务的网站时，域名解析请求将最终由 智能调度 DNS 负责处理；它通过一组预先定义好的策略，将当时最接近用户的节点地址提供给用户，使用户可以得到快速的服务。同时它需要与分布在各地的 CDN 节点保持童心，跟踪个节点的健康状态、容量等信息，确保将用户的请求分配到就近可用的节点上；")])]),_._v(" "),t("li",[t("p",[_._v("缓存功能服务、负载均衡设备、内容 Cache 服务器、共享存储")])])]),_._v(" "),t("h2",{attrs:{id:"_2-2、cdn-访问升级"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2、cdn-访问升级"}},[_._v("#")]),_._v(" 2-2、CDN 访问升级")]),_._v(" "),t("h3",{attrs:{id:"_2-2-1、升级前夜"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-1、升级前夜"}},[_._v("#")]),_._v(" 2-2-1、升级前夜")]),_._v(" "),t("ul",[t("li",[_._v("首先，用户输入访问的域名，操作系统向 LocalDNS 查询域名的 IP 地址")]),_._v(" "),t("li",[_._v("然后，LocalDNS 向 Root DNS 查询域名的授权服务器（这里假设 LocalDNS 的缓存已过期）")]),_._v(" "),t("li",[_._v("然后，Root DNS 将域名授权 DNS 记录回应给 LocalDNS")]),_._v(" "),t("li",[_._v("然后，LocalDNS 得到域名授权的记录后，继续向域名授权 DNS 查询域名的 ip 地址")]),_._v(" "),t("li",[_._v("然后，LocalDNS 将得到的域名 ip 地址返回给客户端")]),_._v(" "),t("li",[_._v("然后，用户得到域名IP地址后，访问站点服务器")]),_._v(" "),t("li",[_._v("最后，站点服务器响应请求，将请求资源返回给客户端")])]),_._v(" "),t("h3",{attrs:{id:"_2-2-1、升级后晚"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-1、升级后晚"}},[_._v("#")]),_._v(" 2-2-1、升级后晚")]),_._v(" "),t("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://leibnize-picbed.oss-cn-shenzhen.aliyuncs.com/img/20200908000114.png",align:""}}),_._v(" "),t("ul",[t("li",[_._v("首先，用户点击网站页面上的内容 URL，经过本地 DNS 系统解析，DNS 系统会最终将域名的解析权交给 CNAME 指向的 CDN 专用 DNS 服务器；")]),_._v(" "),t("li",[_._v("然后，CDN 的 DNS 服务器将 CDN 的全局负载均衡设备 IP 地址返回用户；")]),_._v(" "),t("li",[_._v("然后，用户向 CDN 的全局负载均衡设备发起内容 URL 访问请求；")]),_._v(" "),t("li",[_._v("然后，CDN 全局负载均衡设备根据用户 IP 地址，及用户请求的内容 URL，选择一台用户所属区域的区域负载均衡设备，告诉用户向这台设备发起请求；")]),_._v(" "),t("li",[_._v("然后，区域负载均衡设备会为用户选择一台合适的缓存服务器提供服务，选择的依据基于下述条件综合分析后，区域负载均衡设备会向全局负载均衡设备返回一台缓存服务器的 IP 地址；\n"),t("ul",[t("li",[_._v("根据用户IP地址，判断哪一台服务器距用户最近；")]),_._v(" "),t("li",[_._v("根据用户所请求的URL中携带的内容名称，判断哪一台服务器上有用户所需内容；")]),_._v(" "),t("li",[_._v("查询各个服务器当前的负载情况，判断哪一台服务器尚有服务能力；")])])]),_._v(" "),t("li",[_._v("然后，全局负载均衡设备把服务器的 IP 地址返回给用户；")]),_._v(" "),t("li",[_._v("最后，用户向缓存服务器发起请求，缓存服务器响应用户请求，将用户所需内容传送到用户终端；若这台缓存服务器上并无用户想要的内容，而区域均衡设备依然将它分配给了用户，则此台服务器就要向它的上一级缓存服务器请求内容，直至追溯到网站的源服务器将内容拉到本地；")]),_._v(" "),t("li",[_._v("所以，为实现对普通用户透明(使用缓存后用户无需进行任何设置)访问，需要使用 DNS 来引导用户来访问 Cache 服务器，以实现透明的加速服务;由于用户访问网站的第一步就是域名解析，所以通过修改 DNS 来引导用户访问是最简单有效的方式；")])]),_._v(" "),t("p",[t("strong",[t("u",[_._v("CNAME记录")])])]),_._v(" "),t("p",[_._v("即别名Canonical Name；可用来把一个域名解析成另一个域名，当 DNS 系统在查询 CNAME 左边的名称的时候，都会转向 CNAME 右边的名称在进行查询，一直最总到最后的 PTR 或 A名称，成功查询才会做出回应，否则失败；")]),_._v(" "),t("p",[_._v("比如，用户在某台服务器上存放了数据，一般用 "),t("code",[_._v("doc.example.com")]),_._v(" 去访问这些资源，但又希望通过 "),t("code",[_._v("documents.example.com")]),_._v(" 也能访问到这些资源，则可在的 DNS 解析服务商添加一条 CNAME 记录，将 "),t("code",[_._v("documents.example.com")]),_._v(" 指向 "),t("code",[_._v("doc.example.com")]),_._v(" ，添加记录之后，所有访问 "),t("code",[_._v("documents.example.com")]),_._v(" 的请求都会被转到 "),t("code",[_._v("doc.example.com")]),_._v(" ，并得到相同的响应；")]),_._v(" "),t("p",[t("strong",[t("u",[_._v("CNAME域名")])])]),_._v(" "),t("p",[_._v("接入 CDN 时，在 CDN 提供商控制台添加完加速域名后，您会得到一个 CDN 给您分配的 CNAME域名，您需要在您的 DNS 解析服务上添加 CNAME 记录，将自己的加速域名指向这个 CNAME域名，这样该域名的请求才会指向 CDN 的节点，以达到加速效果；")]),_._v(" "),t("h2",{attrs:{id:"回源host"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#回源host"}},[_._v("#")]),_._v(" 回源host")]),_._v(" "),t("p",[_._v("回源host 决定回源请求访问到原站上的具体站点。")]),_._v(" "),t("blockquote",[t("p",[_._v("例子1：源站是域名源站为 "),t("code",[_._v("www.a.com")]),_._v(" ，回源host为 "),t("code",[_._v("www.b.com")]),_._v(" ，那么实际回源是请求到 "),t("code",[_._v("www.a.com")]),_._v(" 解析到的IP，对应的主机上的站点 "),t("code",[_._v("www.b.com")])]),_._v(" "),t("p",[_._v("例子2：源站是IP源站为 "),t("code",[_._v("1.1.1.1")]),_._v("，回源host为 "),t("code",[_._v("www.b.com")]),_._v("，那么实际回源的是 "),t("code",[_._v("1.1.1.1")]),_._v(" 对应的主机上的站点 "),t("code",[_._v("www.b.com")])])]),_._v(" "),t("h2",{attrs:{id:"协议回源"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#协议回源"}},[_._v("#")]),_._v(" 协议回源")]),_._v(" "),t("p",[_._v("指回源时使用的协议和客户端访问资源时的协议保持一致，即如果客户端使用 HTTPS 方式请求资源，当CDN节点上未缓存该资源时，节点会使用相同的 HTTPS 方式回源获取资源；同理如果客户端使用 HTTP 协议的请求，CDN节点回源时也使用HTTP协议。")]),_._v(" "),t("h2",{attrs:{id:"_2-3、cdn-回源机制"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-3、cdn-回源机制"}},[_._v("#")]),_._v(" 2-3、CDN 回源机制")]),_._v(" "),t("p",[_._v("回源情况：当 CDN 缓存服务器中无符合用户要求的资源时，服务器会请求上级缓存服务器，以此类推，若最后还是没有，就会回到主服务器获取资源；")]),_._v(" "),t("ul",[t("li",[_._v("用户访问时，如节点上无缓存，则会回源拉取资源；")]),_._v(" "),t("li",[_._v("CDN节点上的文件过期，会回源拉取资源；")]),_._v(" "),t("li",[_._v("若为不缓存文件，用户访问时，会直接回源拉取资源；")])]),_._v(" "),t("h2",{attrs:{id:"_2-4、oss-cdn-diff"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-4、oss-cdn-diff"}},[_._v("#")]),_._v(" 2-4、OSS & CDN diff")]),_._v(" "),t("p",[_._v("OSS  全称 Object Storage Service，对象存储服务，其将数据通道(需要访问的数据)和控制通路(元数据，即索引)分离，先根据索引(也就是元数据)找到数据存储的位置，进而通过底层的存储接口来访问数据；通过此方式，对象存储既有类似块存储的存取性能，也有类似文件存储的共享便利，可极佳的存储方式；")]),_._v(" "),t("p",[_._v("场景：对象存储主要用来存储图片、音频、视频等非结构化数据；")]),_._v(" "),t("p",[t("u",[t("em",[_._v("区别：OSS 核心是存储及计算能力，CDN 核心是分发，本身不提供存储接口，故一般情况下两者配合使用：对象存储中存储资源文件，并用 CDN 加速")])]),_._v("；")]),_._v(" "),t("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://leibnize-picbed.oss-cn-shenzhen.aliyuncs.com/img/20200908000115.png",align:""}})])}),[],!1,null,null,null);v.default=e.exports}}]);