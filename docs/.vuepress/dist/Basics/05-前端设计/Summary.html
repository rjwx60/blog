<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>总结 | Leibnize 个人学习笔记</title>
    <meta name="generator" content="VuePress 1.5.4">
    
    <meta name="description" content="整理自网络">
    <link rel="preload" href="/assets/css/0.styles.a3549ad8.css" as="style"><link rel="preload" href="/assets/js/app.f95d0077.js" as="script"><link rel="preload" href="/assets/js/3.49babee5.js" as="script"><link rel="preload" href="/assets/js/1.269e4bda.js" as="script"><link rel="preload" href="/assets/js/87.472635cc.js" as="script"><link rel="prefetch" href="/assets/js/10.6aa86c9d.js"><link rel="prefetch" href="/assets/js/100.2d552503.js"><link rel="prefetch" href="/assets/js/101.380eba67.js"><link rel="prefetch" href="/assets/js/102.4bd44e2f.js"><link rel="prefetch" href="/assets/js/103.c3ba7b95.js"><link rel="prefetch" href="/assets/js/104.93048938.js"><link rel="prefetch" href="/assets/js/105.640b5e1a.js"><link rel="prefetch" href="/assets/js/106.703adc14.js"><link rel="prefetch" href="/assets/js/107.991cb147.js"><link rel="prefetch" href="/assets/js/108.f2bd0aec.js"><link rel="prefetch" href="/assets/js/109.1d937267.js"><link rel="prefetch" href="/assets/js/11.a1d51055.js"><link rel="prefetch" href="/assets/js/110.332390f4.js"><link rel="prefetch" href="/assets/js/111.71635c45.js"><link rel="prefetch" href="/assets/js/112.2ac200df.js"><link rel="prefetch" href="/assets/js/113.46405151.js"><link rel="prefetch" href="/assets/js/114.58fa21b5.js"><link rel="prefetch" href="/assets/js/115.fa6a329a.js"><link rel="prefetch" href="/assets/js/116.37141fb0.js"><link rel="prefetch" href="/assets/js/117.d001fc73.js"><link rel="prefetch" href="/assets/js/118.217b3c9e.js"><link rel="prefetch" href="/assets/js/119.c8e2d03c.js"><link rel="prefetch" href="/assets/js/12.a5c78b74.js"><link rel="prefetch" href="/assets/js/120.f21f9f6d.js"><link rel="prefetch" href="/assets/js/121.610858f8.js"><link rel="prefetch" href="/assets/js/122.5e106cb5.js"><link rel="prefetch" href="/assets/js/123.83e9e543.js"><link rel="prefetch" href="/assets/js/124.fe964328.js"><link rel="prefetch" href="/assets/js/125.48103cb8.js"><link rel="prefetch" href="/assets/js/126.9f3a9a43.js"><link rel="prefetch" href="/assets/js/127.53393403.js"><link rel="prefetch" href="/assets/js/128.718bab74.js"><link rel="prefetch" href="/assets/js/129.94bb906d.js"><link rel="prefetch" href="/assets/js/13.6b06e1eb.js"><link rel="prefetch" href="/assets/js/130.f3cb1be6.js"><link rel="prefetch" href="/assets/js/131.b4e741b6.js"><link rel="prefetch" href="/assets/js/132.dbf75e28.js"><link rel="prefetch" href="/assets/js/133.0f2404ed.js"><link rel="prefetch" href="/assets/js/134.d17dc9c2.js"><link rel="prefetch" href="/assets/js/135.a7c3e822.js"><link rel="prefetch" href="/assets/js/136.2401894d.js"><link rel="prefetch" href="/assets/js/137.6b5d51b3.js"><link rel="prefetch" href="/assets/js/138.46e98d9d.js"><link rel="prefetch" href="/assets/js/139.080c5130.js"><link rel="prefetch" href="/assets/js/14.1f5e418e.js"><link rel="prefetch" href="/assets/js/140.d7deb0d2.js"><link rel="prefetch" href="/assets/js/141.21a0a960.js"><link rel="prefetch" href="/assets/js/142.fe31183f.js"><link rel="prefetch" href="/assets/js/143.8adbd910.js"><link rel="prefetch" href="/assets/js/144.2ad689e4.js"><link rel="prefetch" href="/assets/js/145.95a4a1d7.js"><link rel="prefetch" href="/assets/js/146.45bec800.js"><link rel="prefetch" href="/assets/js/147.93101868.js"><link rel="prefetch" href="/assets/js/148.b534d0a2.js"><link rel="prefetch" href="/assets/js/149.b1d993db.js"><link rel="prefetch" href="/assets/js/15.f2f6dc7a.js"><link rel="prefetch" href="/assets/js/150.e7147d10.js"><link rel="prefetch" href="/assets/js/151.4ef25d94.js"><link rel="prefetch" href="/assets/js/152.e5d9d094.js"><link rel="prefetch" href="/assets/js/153.6b6e0642.js"><link rel="prefetch" href="/assets/js/154.25250e56.js"><link rel="prefetch" href="/assets/js/155.34ae60ca.js"><link rel="prefetch" href="/assets/js/156.26b776db.js"><link rel="prefetch" href="/assets/js/157.ac214951.js"><link rel="prefetch" href="/assets/js/158.8160576b.js"><link rel="prefetch" href="/assets/js/159.87970e93.js"><link rel="prefetch" href="/assets/js/16.f38d5aa1.js"><link rel="prefetch" href="/assets/js/160.cb31f27b.js"><link rel="prefetch" href="/assets/js/161.63da7c1d.js"><link rel="prefetch" href="/assets/js/162.d6265c5a.js"><link rel="prefetch" href="/assets/js/163.00e98ea9.js"><link rel="prefetch" href="/assets/js/164.489d3ece.js"><link rel="prefetch" href="/assets/js/165.14a0ac69.js"><link rel="prefetch" href="/assets/js/17.47f92d25.js"><link rel="prefetch" href="/assets/js/18.939679b9.js"><link rel="prefetch" href="/assets/js/19.4b5e11ca.js"><link rel="prefetch" href="/assets/js/20.e4c5a5c1.js"><link rel="prefetch" href="/assets/js/21.886994a9.js"><link rel="prefetch" href="/assets/js/22.6848ca70.js"><link rel="prefetch" href="/assets/js/23.6685f31e.js"><link rel="prefetch" href="/assets/js/24.6ffcbee7.js"><link rel="prefetch" href="/assets/js/25.b468ab2a.js"><link rel="prefetch" href="/assets/js/26.ae4ec095.js"><link rel="prefetch" href="/assets/js/27.d68ba8c4.js"><link rel="prefetch" href="/assets/js/28.77526965.js"><link rel="prefetch" href="/assets/js/29.b51bc369.js"><link rel="prefetch" href="/assets/js/30.f34ad8ea.js"><link rel="prefetch" href="/assets/js/31.ea5d0968.js"><link rel="prefetch" href="/assets/js/32.266fe651.js"><link rel="prefetch" href="/assets/js/33.9f3a4b59.js"><link rel="prefetch" href="/assets/js/34.92302c41.js"><link rel="prefetch" href="/assets/js/35.258e2870.js"><link rel="prefetch" href="/assets/js/36.7b3f62cb.js"><link rel="prefetch" href="/assets/js/37.91e68fdc.js"><link rel="prefetch" href="/assets/js/38.35c7427c.js"><link rel="prefetch" href="/assets/js/39.565f94d6.js"><link rel="prefetch" href="/assets/js/4.ea3b0bd5.js"><link rel="prefetch" href="/assets/js/40.1df5e2f3.js"><link rel="prefetch" href="/assets/js/41.5b364c9b.js"><link rel="prefetch" href="/assets/js/42.bc29f49d.js"><link rel="prefetch" href="/assets/js/43.2c830543.js"><link rel="prefetch" href="/assets/js/44.db617450.js"><link rel="prefetch" href="/assets/js/45.6d82cbe7.js"><link rel="prefetch" href="/assets/js/46.f36ad277.js"><link rel="prefetch" href="/assets/js/47.11cd07e6.js"><link rel="prefetch" href="/assets/js/48.e03a4e77.js"><link rel="prefetch" href="/assets/js/49.b08b0835.js"><link rel="prefetch" href="/assets/js/5.97a7c0dc.js"><link rel="prefetch" href="/assets/js/50.c4648d27.js"><link rel="prefetch" href="/assets/js/51.e983cd13.js"><link rel="prefetch" href="/assets/js/52.16e738d5.js"><link rel="prefetch" href="/assets/js/53.bd8c1968.js"><link rel="prefetch" href="/assets/js/54.3e19ee76.js"><link rel="prefetch" href="/assets/js/55.b8ad26cd.js"><link rel="prefetch" href="/assets/js/56.311bfbe6.js"><link rel="prefetch" href="/assets/js/57.0f045ba5.js"><link rel="prefetch" href="/assets/js/58.239e8404.js"><link rel="prefetch" href="/assets/js/59.7b687abb.js"><link rel="prefetch" href="/assets/js/6.8e992509.js"><link rel="prefetch" href="/assets/js/60.4e343674.js"><link rel="prefetch" href="/assets/js/61.db6e32e6.js"><link rel="prefetch" href="/assets/js/62.fc3fc01f.js"><link rel="prefetch" href="/assets/js/63.fa9e1bd1.js"><link rel="prefetch" href="/assets/js/64.994d7527.js"><link rel="prefetch" href="/assets/js/65.267b048d.js"><link rel="prefetch" href="/assets/js/66.8c5f0b3d.js"><link rel="prefetch" href="/assets/js/67.74a9ded5.js"><link rel="prefetch" href="/assets/js/68.dd40f558.js"><link rel="prefetch" href="/assets/js/69.00fccbea.js"><link rel="prefetch" href="/assets/js/7.159745e4.js"><link rel="prefetch" href="/assets/js/70.ef8c338c.js"><link rel="prefetch" href="/assets/js/71.25a9bd58.js"><link rel="prefetch" href="/assets/js/72.0959ee8f.js"><link rel="prefetch" href="/assets/js/73.e154307b.js"><link rel="prefetch" href="/assets/js/74.76863de9.js"><link rel="prefetch" href="/assets/js/75.6978bd97.js"><link rel="prefetch" href="/assets/js/76.4a2f4182.js"><link rel="prefetch" href="/assets/js/77.0f06f3c0.js"><link rel="prefetch" href="/assets/js/78.66c253a1.js"><link rel="prefetch" href="/assets/js/79.6c37b127.js"><link rel="prefetch" href="/assets/js/8.eaef2fb9.js"><link rel="prefetch" href="/assets/js/80.2dda282c.js"><link rel="prefetch" href="/assets/js/81.cd9437e7.js"><link rel="prefetch" href="/assets/js/82.c5a84712.js"><link rel="prefetch" href="/assets/js/83.b8a2f734.js"><link rel="prefetch" href="/assets/js/84.ede1cd7a.js"><link rel="prefetch" href="/assets/js/85.e649a4e5.js"><link rel="prefetch" href="/assets/js/86.38274fa9.js"><link rel="prefetch" href="/assets/js/88.cf02af57.js"><link rel="prefetch" href="/assets/js/89.03ef81d7.js"><link rel="prefetch" href="/assets/js/9.ee3f327d.js"><link rel="prefetch" href="/assets/js/90.4a497f88.js"><link rel="prefetch" href="/assets/js/91.7271b82b.js"><link rel="prefetch" href="/assets/js/92.cd04960f.js"><link rel="prefetch" href="/assets/js/93.342921b6.js"><link rel="prefetch" href="/assets/js/94.f5d3d498.js"><link rel="prefetch" href="/assets/js/95.940fefe6.js"><link rel="prefetch" href="/assets/js/96.fdbcc350.js"><link rel="prefetch" href="/assets/js/97.73aba549.js"><link rel="prefetch" href="/assets/js/98.937f6a6d.js"><link rel="prefetch" href="/assets/js/99.bcd70353.js">
    <link rel="stylesheet" href="/assets/css/0.styles.a3549ad8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-dad8a512><div data-v-dad8a512><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-dad8a512 data-v-dad8a512><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-64685f0e data-v-dad8a512 data-v-dad8a512><h3 class="title" style="display:none;" data-v-64685f0e data-v-64685f0e>Leibnize 个人学习笔记</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-64685f0e data-v-64685f0e><input type="password" value="" data-v-64685f0e> <span data-v-64685f0e>Konck! Knock!</span> <button data-v-64685f0e>OK</button></label> <div class="footer" style="display:none;" data-v-64685f0e data-v-64685f0e><span data-v-64685f0e><i class="iconfont reco-theme" data-v-64685f0e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-64685f0e>vuePress-theme-reco</a></span> <span data-v-64685f0e><i class="iconfont reco-copyright" data-v-64685f0e></i> <a data-v-64685f0e><span data-v-64685f0e>Leibnize 个人学习笔记</span>
            
          <!---->
          2020
        </a></span></div></div> <div class="hide" data-v-dad8a512><header class="navbar" data-v-dad8a512><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Leibnize 个人学习笔记</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/rjwx60" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont undefined"></i>
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-dad8a512></div> <aside class="sidebar" data-v-dad8a512><div class="personal-info-wrapper" data-v-ca798c94 data-v-dad8a512><!----> <h3 class="name" data-v-ca798c94>
    Leibnize 个人学习笔记
  </h3> <div class="num" data-v-ca798c94><div data-v-ca798c94><h3 data-v-ca798c94>0</h3> <h6 data-v-ca798c94>Article</h6></div> <div data-v-ca798c94><h3 data-v-ca798c94>0</h3> <h6 data-v-ca798c94>Tag</h6></div></div> <hr data-v-ca798c94></div> <nav class="nav-links"><div class="nav-item"><a href="https://github.com/rjwx60" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont undefined"></i>
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><a href="/Basics/" class="sidebar-heading clickable router-link-active open"><span>前端专题</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/Basics/01-前端基础" class="sidebar-heading clickable"><span>01-前端基本</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/Basics/02-前端性能" class="sidebar-heading clickable"><span>02-前端性能</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/Basics/03-前端工程" class="sidebar-heading clickable"><span>03-前端工程</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/Basics/04-前端异步" class="sidebar-heading clickable"><span>04-前端异步</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/Basics/05-前端设计" class="sidebar-heading clickable open"><span>05-前端设计</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/Basics/05-前端设计/基本内容.html" class="sidebar-link">一、基本内容</a></li><li><a href="/Basics/05-前端设计/面向对象编程.html" class="sidebar-link">二、面向对象</a></li><li><a href="/Basics/05-前端设计/设计模式.html" class="sidebar-link">三、设计模式</a></li><li><a href="/Basics/05-前端设计/架构模式.html" class="sidebar-link">四、架构模式</a></li><li><a href="/Basics/05-前端设计/Summary.html" class="active sidebar-link">五、Summary</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/Basics/06-前端数据" class="sidebar-heading clickable"><span>06-前端数据</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/Basics/07-前端安全" class="sidebar-heading clickable"><span>07-前端安全</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/Basics/08-前端概念" class="sidebar-heading clickable"><span>08-前端概念</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/Basics/09-前端实现" class="sidebar-heading clickable"><span>09-前端实现</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/Basics/10-前端新标" class="sidebar-heading clickable"><span>10-前端新标</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/Basics/11-前端会话" class="sidebar-heading clickable"><span>11-前端会话</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/Basics/12-前端框架" class="sidebar-heading clickable"><span>12-前端框架</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/Basics/14-浏览器相关" class="sidebar-heading clickable"><span>14-浏览器相关</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/Basics/15-前端核心" class="sidebar-heading clickable"><span>15-前端核心</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/Basics/16-前端Node" class="sidebar-heading clickable"><span>16-前端Node</span> <span class="arrow right"></span></a> <!----></section></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/NetWork/" class="sidebar-heading clickable"><span>网络专题</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/NetWork/20-前端网络" class="sidebar-heading clickable open"><span>20-前端网络</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/NetWork/20-前端网络/base.html" class="sidebar-link">一、基本</a></li><li><a href="/NetWork/20-前端网络/ip.html" class="sidebar-link">二、IP</a></li><li><a href="/NetWork/20-前端网络/tcp.html" class="sidebar-link">三、TCP</a></li><li><a href="/NetWork/20-前端网络/dns.html" class="sidebar-link">四、DNS</a></li><li><a href="/NetWork/20-前端网络/http.html" class="sidebar-link">五、HTTP</a></li><li><a href="/NetWork/20-前端网络/websocket.html" class="sidebar-link">六、Websocket</a></li><li><a href="/NetWork/20-前端网络/Summary.html" class="sidebar-link">七、Summary</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/Algorithm/" class="sidebar-heading clickable"><span>算法专题</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/Algorithm/30-前端算法" class="sidebar-heading clickable open"><span>30-前端算法</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/Algorithm/30-前端算法/排序.html" class="sidebar-link">X、排序</a></li><li><a href="/Algorithm/30-前端算法/Summary.html" class="sidebar-link">X、Summary</a></li></ul></section></li></ul></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-64685f0e data-v-dad8a512><h3 class="title" style="display:none;" data-v-64685f0e data-v-64685f0e></h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-64685f0e data-v-64685f0e><input type="password" value="" data-v-64685f0e> <span data-v-64685f0e>Konck! Knock!</span> <button data-v-64685f0e>OK</button></label> <div class="footer" style="display:none;" data-v-64685f0e data-v-64685f0e><span data-v-64685f0e><i class="iconfont reco-theme" data-v-64685f0e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-64685f0e>vuePress-theme-reco</a></span> <span data-v-64685f0e><i class="iconfont reco-copyright" data-v-64685f0e></i> <a data-v-64685f0e><span data-v-64685f0e>Leibnize 个人学习笔记</span>
            
          <!---->
          2020
        </a></span></div></div> <div data-v-dad8a512><main class="page"><div class="page-title" style="display:none;"><h1>总结</h1> <div data-v-3b7f5bdf><i class="iconfont reco-account" data-v-3b7f5bdf><span data-v-3b7f5bdf>Leibnize 个人学习笔记</span></i> <!----> <!----> <!----></div></div> <div class="theme-reco-content content__default" style="display:none;"><h1 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h1> <p>主要厘清实例、构造函数、原型间的关系，这样 <code>__proto__</code> 和 prototype 就明白了；然后适当研究继承的发展历程(大致如下)，主要是寄生组合继承的研究与应用；设计模式单独拎出来说其实有点别扭，主要是思想层面上；</p> <ul><li>首先，最初是 <strong><u>原型链继承</u></strong>，通过将子类实例的原型指向父类实例来继承父类的属性和方法，但原型链继承的缺陷在于<u>对子类实例继承的引用类型的修改会影响到所有的实例对象，以及无法向父类的构造方法传参</u>；</li> <li>因此，引入 <strong><u>构造函数继承</u></strong>, 通过在子类构造函数中调用父类构造函数并传入子类 this 来获取父类的属性和方法，但构造函数继承也存在缺陷，<u>构造函数继承不能继承到父类原型链上的属性和方法</u>；</li> <li>所以，综合两种继承的优点，提出 <strong><u>组合式继承</u></strong>，但组合式继承也引入新问题：<u>其每次创建子类实例都执行两次父类构造方法</u>；最后，通过将子类原型指向父类实例，改为子类原型指向父类原型的浅拷贝来解决这一问题，也即最终实现：<strong><u>寄生组合式继承</u></strong></li></ul> <h2 id="一、基本内容"><a href="#一、基本内容" class="header-anchor">#</a> 一、基本内容</h2> <h3 id="_1-1、关系"><a href="#_1-1、关系" class="header-anchor">#</a> 1-1、关系</h3> <p><strong><u><em>原型</em></u></strong>：显式原型；每个函数特有的属性 prototype，其指向一个对象，此对象及原型；本质是函数在构造调用时，即创建实例过程中，系统自动创建的与函数相关的一个对象；隐式原型；每个对象均有属性 <code>__proto__</code>；鉴于这种隐式原型指向显式原型对象，而对象的隐式原型又指向下一个显式原型对象，而形成的一种的链条结构即 <strong><u><em>原型链</em></u></strong>；本质即链表的数据结构，<code>__proto__</code> 即结点；</p> <ul><li>注意：本来(原型)是内部对象，无法访问的，但浏览器最初却自实现了一个 <code>__proto__</code> 方法，使得实例可通过此来访问得到函数原型；后来被标准化为 prototype；</li> <li>注意：感觉上不管 <code>__proto__</code> 还是 prototype 都能指向原型，只是依附的主体不一样，前者是对象，后者是函数，而隐式还是显式，更多的是代表其过去的历史…(这段话有点表述不清)</li> <li>注意：一般讲到原型链，就会涉及查找更新操作，即 GetSet 操作，若在对象上没有找到需要的属性或者方法引用，引擎就会继续在 [[Prototype]] 关联的对象上进行查找；还涉及 Object.definedProperty 操作，还涉及操作符的操作：
<ul><li>in 操作符(遍历链上所有属性) 等内容；</li> <li>for...in... 能获取到实例对象自身的属性和原型链上的属性(可枚举属性)；</li> <li>Object.keys() 和 Object.getOwnPropertyNames()只能获取实例对象自身属性(可枚举属性)；</li> <li>Object.hasOwnProperty() 方法传入属性名来判断某属性是不是实例自身属性(可枚举属性)；</li></ul></li></ul> <img src="https://leibnize-picbed.oss-cn-shenzhen.aliyuncs.com/img/20200909091153.png" align="" style="zoom:50%;"> <img src="https://leibnize-picbed.oss-cn-shenzhen.aliyuncs.com/img/20200909091157.png" align="" style="zoom:50%;"> <p><strong><u><em>构造函数</em></u></strong>：即函数的构造调用，即函数的 new 调用；并非特殊函数，只是函数在此场景下的别称；</p> <p><strong><u><em>实例</em></u></strong>：即函数构造调用得到的产物；本质是中间对象，或中间对象环境下调用产生的结果(涉及 new 过程)；</p> <p><strong><u><em>关系</em></u></strong>：</p> <ul><li>实例与构造：<code>实例.__proto__ 指向构造它的函数的原型</code>；遂可通过 <code>__proto__</code> 找到其原型并使用其属性和属性；比如：<code>实例.__proto__.constructor</code> (绕来绕去实际就那么回事)；</li> <li>实例与原型：函数与实例间是构造关系</li> <li>构造与原型：函数.prototype 指向函数原型，函数原型即：函数.prototype(没有实体，用属性指向)；而原型，可通过：原型.constructor 指回构造函数；</li> <li>显式与隐式原型关系：对象的隐式原型 <code>__proto__</code> 指向，创建这个对象的函数，的显式原型 prototype；
<ul><li>前者是任意函数在创建后均拥有的属性，其指向函数的原型对象；作用是：实现基于原型的继承与属性共享；
<ul><li>注意：通过 Function.prototype.bind 构造出的函数是例外，其没有 prototype 属性；</li></ul></li> <li>后者是任意 JS 对象，都有内置属性 [[prototype]]，指向创建此对象的函数的显式原型；作用是：构成原型链，同样可用以实现基于原型的继承与属性共享，当找寻某对象属性或方法时，便会沿此进行搜索；
<ul><li>ES5 前，没有标准方法访问此属性(prototype)，但大多数浏览器均支持通过 <code>__proto__</code> 访问；</li> <li>ES5 后，有标准方法可访问：Object.getPrototypeOf()：<code>Object.getPrototypeOf(fn) == test.prototype // true</code></li> <li>注意：Object.prototype 是唯一的，没有原型的对象：</li></ul></li></ul></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 三者的关系(再述):</span>
实例<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> 原型

<span class="token class-name">原型</span><span class="token punctuation">.</span>constructor <span class="token operator">===</span> 构造函数

<span class="token class-name">构造函数</span><span class="token punctuation">.</span>prototype <span class="token operator">===</span> 原型

<span class="token class-name">实例</span><span class="token punctuation">.</span>constructor <span class="token operator">===</span> 构造函数
<span class="token comment">// 注意: 其实实例上并不是真正有 constructor 这个指针，它其实是从原型链上获取的: </span>
<span class="token comment">// instance.hasOwnProperty('constructor') === false </span>

<span class="token comment">// 例如: </span>
<span class="token comment">// const o = new Object()</span>
<span class="token comment">// o.constructor === Object   --&gt; true</span>
<span class="token comment">// o.__proto__ = null;</span>
<span class="token comment">// o.constructor === Object   --&gt; false </span>

<span class="token comment">// 对象原型 prototype 属性 与 构造函数 prototype 属性间区别：</span>
<span class="token comment">// 前者可通过 Object.getPrototypeOf(obj) 或，已被弃用的 __proto__ 属性获得</span>
<span class="token comment">// 前者是每个实例上都有的属性，后者是构造函数的属性</span>
<span class="token comment">// 也就是说，Object.getPrototypeOf(new Foobar())和 Foobar.prototype 指向着同一个对象</span>
<span class="token comment">// function Foobar(){} -&gt; undefined</span>
<span class="token comment">// foobar = new Foobar() -&gt; Foobar {}</span>
<span class="token comment">// Object.getPrototypeOf(foobar) == Foobar.prototype -&gt; true</span>
</code></pre></div><img src="https://leibnize-picbed.oss-cn-shenzhen.aliyuncs.com/img/20200909091146.png" align="" style="zoom:50%;"> <ul><li><u>别再留意下面的注意了!!! 其实没什么特别需要注意的，厘清它们之间的关系就够了!!!</u></li> <li>看上面的图，实例的隐式指向构造它的函数的显式、而函数除了有显式，还应当注意其也是一个对象也有一个隐式原型，而函数的隐式，均指向函数的显式，即 Function.prototype，而原型对象又 TM 是对象，好了，对象又 TM 有隐式，最终指向 Object.prototype，好了，这是老大了，JS  一切均对象就是这么由来的，老大的本源是什么?? null，无中生有；(这段语气有点暴躁，其实是暴躁自己为何这么简单的内容——就一链表，还要跟自己解释这么久…请忽略)；</li> <li>所以注意点只有函数的隐式原型指向 Function.prototype…其实也没啥好注意的，只是大多数人忽略了原来函数也有隐式指向；</li> <li>别再留意下面的注意了!!! 其实没什么特别需要注意的，厘清它们之间的关系就够了!!!</li></ul> <img src="https://leibnize-picbed.oss-cn-shenzhen.aliyuncs.com/img/20200909091158.png" style="zoom:50%;"> <p><strong><u><em>注意</em></u></strong> (感觉实际上不用注意，略看)：</p> <ul><li><p>任何对象均函数，均继承 Function 所有属性和方法，而 Function 是内置的构造函数也是对象，均继承 Object 的所有属性方法；</p></li> <li><p>各种 function、Object、Function 等实际上均为 new Function() 后的实例，而这些实例原型 <code>__proto__</code> 均指向 Function.prototype；同理：Object、Number、String、Array、Function、Date 等均为函数，而所有函数均由 Function 创建，故其原型 <code>__proto__</code> 指向 Function.prototype：</p></li> <li><p><code>__proto__</code> 为 构造器原型；</p> <ul><li><div class="language-js extra-class"><pre class="language-js"><code>__proto__ <span class="token operator">==</span> constructor<span class="token punctuation">.</span>prototype <span class="token comment">// true</span>
<span class="token comment">// 实际上是 - 饶了一圈...</span>
window<span class="token punctuation">.</span>__proto__ <span class="token operator">==</span> window<span class="token punctuation">.</span>constructor<span class="token punctuation">.</span>prototype
window<span class="token punctuation">.</span>__proto__ <span class="token operator">==</span> window<span class="token punctuation">.</span><span class="token class-name">__proto__</span><span class="token punctuation">.</span>constructor<span class="token punctuation">.</span>prototype
</code></pre></div></li></ul></li> <li><p><code>__proto__</code> 实际上是 getter setter，源于 Object.prototype，使用时可理解成返回 Object.getPrototypeOf(obj)；</p> <ul><li><div class="language-js extra-class"><pre class="language-js"><code>Object<span class="token punctuation">.</span><span class="token function">getPrototypeOf</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span> <span class="token operator">==</span> fn__proto__ <span class="token comment">// true</span>
</code></pre></div></li></ul></li> <li><p><code>__proto__</code> 指向取决于对象创建的实现方式，图3-5；</p></li></ul> <img src="https://leibnize-picbed.oss-cn-shenzhen.aliyuncs.com/img/20200909091141.png" align="" style="zoom:50%;"> <img src="https://leibnize-picbed.oss-cn-shenzhen.aliyuncs.com/img/20200909091142.png" align="" style="zoom:50%;"> <img src="https://leibnize-picbed.oss-cn-shenzhen.aliyuncs.com/img/20200909091143.png" align="" style="zoom:50%;"> <h3 id="_1-2、new-instanceof"><a href="#_1-2、new-instanceof" class="header-anchor">#</a> 1-2、new &amp; instanceof</h3> <p><strong><u><em>new 过程</em></u></strong>：看下面描述即可：</p> <ul><li><strong>1、new 过程中，内部会创建一中间对象，并继承构造函数 prototype</strong>；以继承构造函数原型上的属性和方法；</li> <li><strong>2、在中间对象中执行构造函数(apply)，以修改 this 指向为返回值/中间对象</strong>；以实现构造函数内的赋值操作；</li> <li><strong>3、返回值</strong> (规范规定，若构造方法返回对象，则返回该对象，否则返回中间对象)；</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// new 是关键字, 这里用函数来模拟, new Foo(args) &lt;=&gt; myNew(Foo, args)</span>
<span class="token keyword">function</span> <span class="token function">myNew</span><span class="token punctuation">(</span><span class="token parameter">foo<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 1、创建新对象, 并继承构造方法的 prototype 属性</span>
  <span class="token comment">// 为了把 obj 挂原型链上, 继承构造函数原型上的属性和方法，相当于 obj.__proto__ = Foo.prototype </span>
  <span class="token keyword">let</span> obj <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>foo<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span>  
  
  <span class="token comment">// 2、执行构造方法, 并为其绑定新 this</span>
  <span class="token comment">// 为了让构造方法能进行 this.name = name 类似操作,为了执行构造函数内的赋值操作, args 是构造方法的入参, 因为此处用 myNew 模拟, 故入参从 myNew 传入</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token function">foo</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> args<span class="token punctuation">)</span>

  <span class="token comment">// 3、若构造方法已 return 了一个对象，则就返回该对象，否则返回 myNew 创建的新对象</span>
  <span class="token comment">// 一般情况下，构造方法不会返回新实例，但使用者可以选择返回新实例来覆盖 new 创建的对象</span>
  <span class="token keyword">return</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'[object Object]'</span> <span class="token operator">?</span> result <span class="token operator">:</span> obj
<span class="token punctuation">}</span>

<span class="token comment">// 测试：</span>
<span class="token keyword">function</span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
<span class="token punctuation">}</span>
<span class="token keyword">const</span> newObj <span class="token operator">=</span> <span class="token function">myNew</span><span class="token punctuation">(</span>Foo<span class="token punctuation">,</span> <span class="token string">'zhangsan'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newObj<span class="token punctuation">)</span>                 <span class="token comment">// Foo {name: &quot;zhangsan&quot;}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newObj <span class="token keyword">instanceof</span> <span class="token class-name">Foo</span><span class="token punctuation">)</span>  <span class="token comment">// true</span>
</code></pre></div><p><strong><u><em>instanceof 过程</em></u></strong>：即遍历搜索左侧的隐式原型，是否存在与右边显式原型相等的对象；</p> <p>即 <code>left Value.__proto__.__proto__.__proto__</code>... ，直至找到 / 到达顶层为止</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">instance_of</span><span class="token punctuation">(</span><span class="token parameter"><span class="token constant">L</span><span class="token punctuation">,</span> <span class="token constant">R</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> <span class="token constant">O</span> <span class="token operator">=</span> <span class="token class-name">R</span><span class="token punctuation">.</span>prototype <span class="token comment">// 取 R 显式原型</span>
  <span class="token constant">L</span> <span class="token operator">=</span> <span class="token constant">L</span><span class="token punctuation">.</span>__proto__<span class="token punctuation">;</span>		<span class="token comment">// 取 L 隐式原型</span>
  <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token constant">L</span> <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token constant">L</span> <span class="token operator">===</span> <span class="token constant">O</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>	<span class="token comment">// 注意严格相等</span>
    <span class="token constant">L</span> <span class="token operator">=</span> <span class="token constant">L</span><span class="token punctuation">.</span>__proto__<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong><u><em>instanceof 其他注意事项：</em></u></strong></p> <p>注意：过去 instanceof 用于判断数组是否属于 Array 对象，但问题是数组 instanceof Object 仍为 true，皆因其内部的遍历搜索，数组.隐式原型 ==  Array.prototype == true，Array.prototype.隐式原型也 == Object.prototype，所以无法准确判断；不能用来作为判断数据类型的方法，或基本只用于判断数组类型值；</p> <p>注意：若修改 prototype 的 值，则会改变原有(图2)</p> <img src="https://leibnize-picbed.oss-cn-shenzhen.aliyuncs.com/img/20200909091202.png" align="" style="zoom:50%;"> <img src="https://leibnize-picbed.oss-cn-shenzhen.aliyuncs.com/img/20200909091203.png" align="" style="zoom:50%;"> <p>注意：Fun 是单纯的函数，<code>Fun.__proto__</code> 属于 Function.prototype，但除非 new 出来，否则不属于 Fun.prototype；</p> <img src="https://leibnize-picbed.oss-cn-shenzhen.aliyuncs.com/img/20200923100809.png" alt="截屏2020-09-23 上午10.08.02" style="zoom:67%;"> <p>注意：JS 在访问 str 属性时创建临时 String 对象 (假设叫tmpStr)，并在得到此返回值时销毁临时对象，故此处是 <code>tmpStr.__proto__</code> 的值；而引用类型的字面量和基础类型的不一样(图2)；</p> <img src="https://leibnize-picbed.oss-cn-shenzhen.aliyuncs.com/img/20200909091205.png" align="" style="zoom:50%;"> <img src="https://leibnize-picbed.oss-cn-shenzhen.aliyuncs.com/img/20200909091206.png" align="" style="zoom:50%;"> <p>注意：对于三种基本类型的字面声明，instanceof 均返回 false；而其他类型的字面量声明则为 true；</p> <img src="https://leibnize-picbed.oss-cn-shenzhen.aliyuncs.com/img/20200909091207.png" align="" style="zoom:50%;"> <img src="https://leibnize-picbed.oss-cn-shenzhen.aliyuncs.com/img/20200909091208.png" align="" style="zoom:50%;"> <p>注意：<code>Object.prototype.__proto__</code> 为 null，但 null 不等于 <code>Object.prototype</code>；</p> <img src="https://leibnize-picbed.oss-cn-shenzhen.aliyuncs.com/img/20200909091209.png" align="" style="zoom:50%;"> <p>注意：Object instanceof Object</p> <img src="https://leibnize-picbed.oss-cn-shenzhen.aliyuncs.com/img/20200909091210.png" align="" style="zoom:50%;"> <p>注意：Function instanceof Function</p> <img src="https://leibnize-picbed.oss-cn-shenzhen.aliyuncs.com/img/20200909091211.png" align="" style="zoom:50%;"> <p>注意：Foo instanceof Foo</p> <img src="https://leibnize-picbed.oss-cn-shenzhen.aliyuncs.com/img/20200909091212.png" align="" style="zoom:50%;"> <h2 id="二、面向对象编程"><a href="#二、面向对象编程" class="header-anchor">#</a> 二、面向对象编程</h2> <p>面向对象编程：OOP：将构成问题事务分解成单或多个对象，但分拆成对象并非为了完成某一步骤，而为描述某个事物在整个解决问题的步骤中的行为；示例：Eat(Dog，Apple)；具有良好的可移植性和可扩展性；特性：多态、封装、继承</p> <p>面向过程编程：POP：分析出解决问题所需步骤，然后用方法将各个步骤逐一实现，使用时依次调用；示例：Dog.eat(apple)；优点：同步思维开发；但牵一发而动全身，移植性和可扩展性差；</p> <p>面向组件编程：COP；面向方面编程——AOP；面向服务编程：SOP；</p> <p>但是：JS 很容易模拟一个类，且可一定程度上做到面向对象中的三大特性：封装、继承、多态；尤其是继承，从 ES5 的模拟到 ES6 的语法糖，但最终目的，还是为方便程序员用面向对象的方式来组织代码；</p> <h3 id="_2-1、多态-封装"><a href="#_2-1、多态-封装" class="header-anchor">#</a> 2-1、多态&amp;封装</h3> <p><strong><u><em>多态</em></u></strong>：即根据传入参数的个数不同，调用相应的方法，而 JS 是弱类型，不存在编译时要确定类型，天然支持多态；即在对象内部通过判断类型进行多态开发；</p> <p><strong><u><em>封装</em></u></strong>：将客观事物封装成抽象的类，隐藏属性和方法的实现细节，仅对外公开接口(可见性控制)；JS 通过闭包实现封装；</p> <p>ES6 class 为语法糖， JS 没有类，只是模拟行为，均借助于：原型对象、构造函数来实现；</p> <ul><li><p>私有属性/方法：只能在构造函数内访问不能被外部所访问：构造函数内使用 var 等声明的属性/方法；</p></li> <li><p>公有属性/方法(实例方法)：对象外可访问到对象内的属性和方法：构造函数内使用 this 或构造函数原型 prototype 上设置；</p></li> <li><p>静态属性/方法：定义在构造函数上的方法，无需实例即可调用；</p></li> <li><p>注意：类不会提升(不像普通变量和函数)，注意报错；</p></li> <li><p>注意：constructor 的 var 等声明变量为私有变量不可获取</p></li> <li><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">TLP</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 在 constructor 声明，通过 var 声明 - undefined window</span>
    <span class="token comment">// var type = 'fykms'</span>
    <span class="token comment">// 在 constructor 声明，且不通过 var 声明 - undefined oldman1</span>
    <span class="token comment">// type = 'old man1'</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'tlp'</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 不在 constructor 声明，且不通过 var 声明 - hi3 window</span>
  <span class="token comment">// type = 'hi3'</span>
  <span class="token comment">// 不在 constructor 声明，通过 var 声明 - 报错: Uncaught SyntaxError: Unexpected identifier</span>
  <span class="token comment">// var type = 'hi4';</span>
  <span class="token function-variable function">getType</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>type<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> type <span class="token operator">=</span> <span class="token string">'window'</span>
<span class="token keyword">var</span> tlp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TLP</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
tlp<span class="token punctuation">.</span><span class="token function">getType</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div></li> <li><p>注意：ES6 的 ES5 对应转换：</p> <ul><li>Constructor <strong><u>外部</u></strong>：箭头函数方法、属性最终变为实例 this 上的方法/属性，优先级较低；</li> <li>Constructor <strong><u>内部</u></strong>：this 方法、this 属性最终变为实例 this 上的方法/属性，优先级较高，会覆盖前者同名值；</li> <li>Constructor <strong><u>内部</u></strong>：普通定义的方法/属性最终变为实例的普通方法/属性；</li> <li>Constructor <strong><u>外部</u></strong>：普通定义的方法，最终变为原型链方法；</li></ul></li></ul> <img src="https://leibnize-picbed.oss-cn-shenzhen.aliyuncs.com/img/20200909091213.png" style="zoom:70%;"> <h3 id="_2-2、继承"><a href="#_2-2、继承" class="header-anchor">#</a> 2-2、继承</h3> <p><strong><u><em>继承</em></u></strong>：将属性和方法组装成一个类的过程(私有化变量和方法 (通过 this 创建的属性视作为公有变量，通过 <u>闭包</u> 还可实现对私有变量的访问))；JS 中没有类概念；可通过作用域的变量访问限制，以模拟类实现，比如：构造函数、<code>Object.create()</code>、点语法；</p> <ul><li>方法1：<u>通过构造函数添加类</u>：在函数中创建 this 相关属性和方法，再通过 new 生成实例和绑定 this，例略；
<ul><li>好处：实例间相互独立，不受影响；</li> <li>坏处：好处即坏处，通过 this 定义的属性或方法，每次实例化都复制一份，内存消耗大、复杂、可读性；</li></ul></li> <li>方法2：<u>通过原型添加类</u>：基于 <code>实例.__proto__</code> 指向 函数原型，从而使用原型上的方法；
<ul><li>好处：原型链上的属性和方法只需建立一次;</li> <li>坏处：原型链上的属性和方法为全体实例共用，若链上的属性是引用类型则会被改变(而链上的方法铁定会改变)，不能实现私有属性和私有方法；</li></ul></li> <li>方法3：<u>通过点语法</u>：在构造函数身上通过点语法增加属性或方法；
<ul><li>好处：仅创建一次；</li> <li>坏处：显而易见，实例无法访问，仅能用过自身访问；</li></ul></li></ul> <p><strong><u>继承发展</u></strong>：这个跟模块化发展一样，细节颇多…反正历经数代、多种模式的发展，最终形成以寄生组合式继承为核心的模式：</p> <img src="https://leibnize-picbed.oss-cn-shenzhen.aliyuncs.com/img/20200909091215.png" align="" style="zoom:50%;"> <p><strong><u>1、构造函数继承-不使用 Object.create：</u></strong></p> <ul><li><p><strong><u>1-1、原型链继承</u></strong>：即直接让子类原型对象指向父类实例，当子类实例找不到相应属性和方法时，就会往其原型对象，也即父类实例上找，从而实现对父类属性和方法的继承；<strong><u>关键</u></strong>：<code>子类.prototype = new 父类(); 子类.prototype.constructor = 子类;</code></p></li> <li><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 父类</span>
<span class="token keyword">function</span> <span class="token function">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'特朗普'</span> <span class="token punctuation">}</span>
<span class="token comment">// 父类原型方法</span>
<span class="token class-name">Parent</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token punctuation">}</span>
<span class="token comment">// 子类</span>
<span class="token keyword">function</span> <span class="token function">Child</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token comment">// 1、让子类的原型对象指向父类实例, 当子类实例找不到相应属性和方法时，就会往其原型对象(父类实例)上找</span>
<span class="token class-name">Child</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 1-1、但凡对 prototype 作赋值操作，均需重新将 prototype.constructor 修正为子类构造函数</span>
<span class="token class-name">Child</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> Child 


<span class="token comment">// 2、测试</span>
<span class="token keyword">const</span> child <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Child</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
child<span class="token punctuation">.</span>name          <span class="token comment">// '特朗普'</span>
child<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>     <span class="token comment">// '特朗普'</span>
<span class="token comment">// 3、缺点: </span>
<span class="token comment">// 3-1、覆盖了子类.prototype 方法属性, 不解释</span>
<span class="token comment">// 3-2、父类引用属性被全体子类实例所公用即相互影响，这是一个多对一结构；</span>
<span class="token comment">// 3-3、无法向父类传参，仅 prototype 连接，告诉我怎么传</span>
<span class="token comment">// 4、优点</span>
<span class="token comment">// 4-1、可使用父类方法</span>
</code></pre></div></li> <li><p><strong><u>1-2、构造函数继承：</u><strong>即在子类的构造函数中执行父类的构造函数，并为其绑定子类的 <code>this</code>，让父类的构造函数将成员属性和方法，都挂到 <code>子类的 this</code>上去，避免原型继承中，实例间共享同一原型实例问题，此外还能向父类构造方法传参；</strong><u>关键</u></strong>： 在子类函数中执行：<code>父类函数.apply/call(this, arguments/…arguments);</code></p></li> <li><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 父类</span>
<span class="token keyword">function</span> <span class="token function">Parent</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token comment">// 父类原型方法</span>
<span class="token class-name">Parent</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token punctuation">}</span>
<span class="token comment">// 子类</span>
<span class="token keyword">function</span> <span class="token function">Child</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  	<span class="token comment">// 1、单纯执行父类构造方法并绑定子类 this, 使父类中的属性能够赋到子类的 this 上</span>
    <span class="token function">Parent</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span>   
<span class="token punctuation">}</span>


<span class="token comment">// 2、传参测试</span>
<span class="token keyword">const</span> child1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Child</span><span class="token punctuation">(</span><span class="token string">'test1'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> child2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Child</span><span class="token punctuation">(</span><span class="token string">'test2'</span><span class="token punctuation">)</span>
<span class="token comment">// 3、共享测试</span>
child1<span class="token punctuation">.</span>name<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'foo'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>child1<span class="token punctuation">.</span>name<span class="token punctuation">)</span>          <span class="token comment">// ['foo'] </span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>child2<span class="token punctuation">.</span>name<span class="token punctuation">)</span>          <span class="token comment">// ['test2']</span>
<span class="token comment">// 4、原型链继承测试</span>
child2<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                  <span class="token comment">// Error</span>
<span class="token comment">// 5、缺点:</span>
<span class="token comment">// 5-1、无法继承父类原型上的属性和方法，因为只是单纯的在子类执行，获取父类构造中的方法和属性</span>
<span class="token comment">// 5-2、无法实现复用，每个子类都有父类实例函数的副本，影响性能 (无法复用是因为父类原型链上属性方法子类完全无法用到)</span>
<span class="token comment">// 6、优点:</span>
<span class="token comment">// 6-1、父类引用属性不被共享</span>
<span class="token comment">// 6-2、子类构建实例时可向父类传递参数；</span>
</code></pre></div></li> <li><p>**<u>1-3、组合式继承：</u>**即将原型链继承和构造函数继承各有互补的优缺点，合体为组合式继承；</p></li> <li><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 父类</span>
<span class="token keyword">function</span> <span class="token function">Parent</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">;</span>
  	<span class="token keyword">this</span><span class="token punctuation">.</span>play <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 父类原型方法</span>
<span class="token class-name">Parent</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token punctuation">}</span>
<span class="token comment">// 子类</span>
<span class="token keyword">function</span> <span class="token function">Child</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 1、构造函数的继承 复制父类构造属性方法给子类实例 - 二次调用 Parent</span>
    <span class="token function">Parent</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  	<span class="token comment">// 1-1、为避免被父类同名属性覆盖，在 call/apply 后才为子类创建属性值</span>
  	<span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 2、原型链的继承 - 一次调用 Parent</span>
<span class="token class-name">Child</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 2-1、但凡对 prototype 作赋值操作，均需重新将 prototype.constructor 修正为子类构造函数</span>
<span class="token class-name">Child</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> Child
<span class="token comment">// 子类原型方法</span>
<span class="token class-name">Child</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getAge</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token punctuation">}</span>


<span class="token comment">// 3、传参测试</span>
<span class="token keyword">const</span> child1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Child</span><span class="token punctuation">(</span><span class="token string">'TPP'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> child2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Child</span><span class="token punctuation">(</span><span class="token string">'TLP'</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">)</span>
<span class="token comment">// 4、原型链继承测试</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'child1'</span><span class="token punctuation">,</span> child1<span class="token punctuation">)</span><span class="token punctuation">;</span>		
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>child1<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> child1<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// ['TPP'] 20</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>child1 <span class="token keyword">instanceof</span> <span class="token class-name">Child</span><span class="token punctuation">,</span> child1 <span class="token keyword">instanceof</span> <span class="token class-name">Parent</span><span class="token punctuation">)</span> <span class="token comment">// true true</span>
<span class="token comment">// 5、共享测试</span>
child1<span class="token punctuation">.</span>name<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'foo'</span>
child1<span class="token punctuation">.</span>play<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>child1<span class="token punctuation">.</span>play<span class="token punctuation">,</span> child2<span class="token punctuation">.</span>play<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [1,2,3,4] [1,2,3]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>child1<span class="token punctuation">.</span>name<span class="token punctuation">)</span>          <span class="token comment">// ['foo']</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>child2<span class="token punctuation">.</span>name<span class="token punctuation">)</span>          <span class="token comment">// ['TLP']</span>
child2<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                  <span class="token comment">// ['TLP']</span>
<span class="token comment">// 6、优点:</span>
<span class="token comment">// 父类的方法可以被复用；</span>
<span class="token comment">// 父类的引用属性不会被共享；</span>
<span class="token comment">// 子类构建实例时可以向父类传递参数；</span>
<span class="token comment">// 7、缺点:</span>
<span class="token comment">// 每次创建子类实例都执行了两次构造函数，虽不影响对父类的继承，但子类创建实例时，原型中会存在两份相同的属性和方法</span>
<span class="token comment">// 一次调用 Parent()：给 Child.prototype 写入两个属性 name，play (可通过 child1.__proto__.play 访问得到)</span>
<span class="token comment">// 二次调用 Parent()：给 Child 写入两个属性 name、play；</span>
<span class="token comment">// 再解释：实例对象 child1 上的两个属性就屏蔽了其原型对象 Child.prototype 的两个同名属性；</span>
<span class="token comment">// 所以，缺点是在使用子类创建实例对象时，其原型中会存在两份相同的父类实例的属性/方法；这种被覆盖的情况造成性能浪费</span>
</code></pre></div><img src="https://leibnize-picbed.oss-cn-shenzhen.aliyuncs.com/img/20200909091215.png" align="" style="zoom:50%;"></li></ul> <p><strong><u>2、非构造函数继承-使用 Object.create：(其实主看上面，而非此小节，因思路很…)</u></strong></p> <ul><li><p><strong><u>2-1、原型式继承</u></strong>：即对传入其中的对象执行一次浅拷贝，将构造函数 <code>F</code> 的原型直接指向传入的对象；(略)</p></li> <li><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ES5 规范为 Object.create 方法</span>
<span class="token keyword">function</span> <span class="token function">object</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token constant">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token class-name">F</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> obj
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> person <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">&quot;Nicholas&quot;</span><span class="token punctuation">,</span>
  friends<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;Shelby&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Court&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Van&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> p1 <span class="token operator">=</span> <span class="token function">object</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span>
p1<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;Greg&quot;</span><span class="token punctuation">;</span>
p1<span class="token punctuation">.</span>friends<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&quot;Rob&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> p2 <span class="token operator">=</span> <span class="token function">object</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span>
p2<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;Linda&quot;</span><span class="token punctuation">;</span>
p2<span class="token punctuation">.</span>friends<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&quot;Barbie&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span>friends<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// &quot;Shelby,Court,Van,Rob,Barbie&quot;</span>
<span class="token comment">// 1、优点:</span>
<span class="token comment">// 1-1、父类方法可以复用</span>
<span class="token comment">// 2、缺点</span>
<span class="token comment">// 2-1、原型链继承多个实例的引用类型属性指向相同，存在篡改的可能</span>
<span class="token comment">// 2-2、子类构建实例时不能向父类传递参数</span>
</code></pre></div></li> <li><p>**<u>2-2、寄生式继承：</u>**使用原型式继承获得一份目标对象的 <code>浅拷贝</code>，然后增强了此浅拷贝的能力；优缺点：其实和原型式继承一样，寄生式继承说白了就是：能在拷贝来的对象上加点方法，也就是所谓增强能力；</p></li> <li><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">object</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token constant">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
  <span class="token class-name">F</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> obj
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">p2</span><span class="token punctuation">(</span><span class="token parameter">original</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 通过调用函数创建一个新对象</span>
  <span class="token keyword">let</span> clone <span class="token operator">=</span> <span class="token function">object</span><span class="token punctuation">(</span>original<span class="token punctuation">)</span>
  <span class="token comment">// 以某种方式来增强对象</span>
  clone<span class="token punctuation">.</span><span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">...</span>  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> clone
<span class="token punctuation">}</span>

<span class="token keyword">let</span> person <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'Asuna'</span><span class="token punctuation">,</span>
  friends<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'Kirito'</span><span class="token punctuation">,</span> <span class="token string">'Yuuki'</span><span class="token punctuation">,</span> <span class="token string">'Sinon'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> inst1 <span class="token operator">=</span> <span class="token function">p2</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span>
<span class="token keyword">let</span> inst2 <span class="token operator">=</span> <span class="token function">p2</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span>
<span class="token comment">// 1、优点:</span>
<span class="token comment">// 1-1、父类方法可以复用</span>
<span class="token comment">// 2、缺点</span>
<span class="token comment">// 2-1、原型链继承多个实例的引用类型属性指向相同，存在篡改的可能</span>
<span class="token comment">// 2-2、子类构建实例时不能向父类传递参数</span>
</code></pre></div></li></ul> <p>**<u>3、终极形态：寄生组合式继承：</u>**专注于构造函数继承中的组合式继承改进：组合继承会有两次调用父类的构造函数而造成浪费的缺点，寄生组合继承核心即在解决此问题：<u>让子类的 prototype 指向父类原型的拷贝</u>，如此就不会调用父类的构造函数，进而引发内存的浪费问题；即构造函数被执行两次的问题，将 <code>指向父类实例</code> 改为 <code>指向父类原型</code>，减去一次构造函数的执行；</p> <p>但由于子类原型和父类原型指向同一个对象：<code>Child.prototype = Parent.prototype</code>，故对子类原型的操作会影响到父类原型；</p> <ul><li><p>比如：给 <code>Child.prototype</code> 增加一个getName() 方法，会导致 <code>Parent.prototype</code> 也增加或被覆盖一个 getName() 方法；</p></li> <li><p>解决：可对 <code>Parent.prototype</code> 做浅拷贝，利用 <u>空对象</u> 作为中介，此几乎不占内存，且修改 子类 的 prototype 对象，也不会影响到 父类 的 prototype 对象；注意：后续演进中的 super() 作用也大致如此；</p></li> <li><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 父类</span>
<span class="token keyword">function</span> <span class="token function">Parent</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">;</span>
  	<span class="token keyword">this</span><span class="token punctuation">.</span>play <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 父类原型方法</span>
<span class="token class-name">Parent</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token punctuation">}</span>
<span class="token comment">// 子类</span>
<span class="token keyword">function</span> <span class="token function">Child</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 1、构造函数的继承 </span>
  	<span class="token comment">// 复制父类构造属性方法给子类实例</span>
    <span class="token function">Parent</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  	<span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 2、原型链的继承</span>
<span class="token comment">// Child.prototype = new Parent()</span>
<span class="token comment">// 3、组合继承</span>
<span class="token comment">// Child.prototype = Parent.prototype  </span>
<span class="token comment">// 4、寄生组合继承</span>
<span class="token comment">// 寄生组合式继承中，将组合式继承的 指向父类实例 改为 指向父类原型，并使用浅拷贝避免父子原型间的影响</span>
<span class="token class-name">Child</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">Parent</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span>  
<span class="token comment">// 但凡对 prototype 作赋值操作，均需重新将 prototype.constructor 修正为子类构造函数</span>
<span class="token class-name">Child</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> Child
<span class="token class-name">Child</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getAge</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>age
<span class="token punctuation">}</span>

<span class="token comment">// 5、传参测试</span>
<span class="token keyword">const</span> child1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Child</span><span class="token punctuation">(</span><span class="token string">'TPP'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> child2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Child</span><span class="token punctuation">(</span><span class="token string">'TLP'</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">)</span>
<span class="token comment">// 6、原型链继承测试</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'child1'</span><span class="token punctuation">,</span> child1<span class="token punctuation">)</span><span class="token punctuation">;</span>		
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>child1<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> child1<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// ['TPP'] 20</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>child1 <span class="token keyword">instanceof</span> <span class="token class-name">Child</span><span class="token punctuation">,</span> child1 <span class="token keyword">instanceof</span> <span class="token class-name">Parent</span><span class="token punctuation">)</span> <span class="token comment">// true true</span>
child1<span class="token punctuation">.</span>name<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'foo'</span>
child1<span class="token punctuation">.</span>play<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 7、共享测试</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>child1<span class="token punctuation">.</span>play<span class="token punctuation">,</span> child2<span class="token punctuation">.</span>play<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [1,2,3,4] [1,2,3]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>child1<span class="token punctuation">.</span>name<span class="token punctuation">)</span>          <span class="token comment">// ['foo']</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>child2<span class="token punctuation">.</span>name<span class="token punctuation">)</span>          <span class="token comment">// ['TLP']</span>
child2<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                  <span class="token comment">// ['TLP']</span>
</code></pre></div></li></ul> <p><strong><u>4、最优解</u></strong></p> <p>首先，最初是 <strong><u>原型链继承</u></strong>，通过将子类实例的原型指向父类实例来继承父类的属性和方法，但原型链继承的缺陷在于<u>对子类实例继承的引用类型的修改会影响到所有的实例对象，以及无法向父类的构造方法传参</u>；</p> <p>因此，引入 <strong><u>构造函数继承</u></strong>, 通过在子类构造函数中调用父类构造函数并传入子类 this 来获取父类的属性和方法，但构造函数继承也存在缺陷，<u>构造函数继承不能继承到父类原型链上的属性和方法</u>；</p> <p>所以，综合两种继承的优点，提出 <strong><u>组合式继承</u></strong>，但组合式继承也引入了新的问题：<u>它每次创建子类实例都执行了两次父类构造方法</u>；最后，通过将子类原型指向父类实例，改为子类原型指向父类原型的浅拷贝来解决这一问题，也即最终实现：<strong><u>寄生组合式继承</u></strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> inherit <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">c<span class="token punctuation">,</span>p</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">var</span> <span class="token function-variable function">F</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">c<span class="token punctuation">,</span>p</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// 中间对象</span>
		<span class="token class-name">F</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> p<span class="token punctuation">.</span>prototype<span class="token punctuation">;</span>
    <span class="token comment">// 子类 prototype 通过中间对象寻找 父类 prototype, 避免子类原型操作影响父类</span>
		c<span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 备用: 为子对象设置 uber 属性，其指向父对象的 prototype 属性，仅用欧冠与实现继承完备性，纯属备用性质</span>
		c<span class="token punctuation">.</span>uber <span class="token operator">=</span> p<span class="token punctuation">.</span>prototype<span class="token punctuation">;</span>
		<span class="token comment">// 修复子类实例的构造函数错误指向</span>
		c<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> c<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>



<span class="token comment">// 其他: ES6 语法糖 class / extends</span>
<span class="token comment">// 拓展: Extend 编译源码</span>
<span class="token keyword">function</span> <span class="token function">_possibleConstructorReturn</span><span class="token punctuation">(</span><span class="token parameter">self<span class="token punctuation">,</span> call</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
    <span class="token keyword">return</span> call <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> call <span class="token operator">===</span> <span class="token string">'object'</span> <span class="token operator">||</span> <span class="token keyword">typeof</span> call <span class="token operator">===</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token operator">?</span> call <span class="token operator">:</span> self<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 核心</span>
<span class="token keyword">function</span> <span class="token function">_inherits</span><span class="token punctuation">(</span><span class="token parameter">subClass<span class="token punctuation">,</span> superClass</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
 		<span class="token comment">// 子类的原型的__proto__指向父类的原型</span>
    subClass<span class="token punctuation">.</span>prototype <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>superClass <span class="token operator">&amp;&amp;</span> superClass<span class="token punctuation">.</span>prototype<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      	<span class="token comment">// 给子类添加 constructor 属性 subclass.prototype.constructor === subclass</span>
        constructor<span class="token operator">:</span> <span class="token punctuation">{</span>
            value<span class="token operator">:</span> subClass<span class="token punctuation">,</span>
            enumerable<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            writable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            configurable<span class="token operator">:</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  	<span class="token comment">// 用来继承父类的静态方法, 寄生组合遗漏地方</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>superClass<span class="token punctuation">)</span> Object<span class="token punctuation">.</span>setPrototypeOf <span class="token operator">?</span> Object<span class="token punctuation">.</span><span class="token function">setPrototypeOf</span><span class="token punctuation">(</span>subClass<span class="token punctuation">,</span> superClass<span class="token punctuation">)</span> <span class="token operator">:</span> subClass<span class="token punctuation">.</span>__proto__ <span class="token operator">=</span> superClass<span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">var</span> <span class="token function-variable function">Parent</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 验证是否是 Parent 构造出来的 this</span>
    <span class="token function">_classCallCheck</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> Parent<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> Child <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">_Parent</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  	<span class="token comment">// 采用寄生组合继承方式</span>
    <span class="token function">_inherits</span><span class="token punctuation">(</span>Child<span class="token punctuation">,</span> _Parent<span class="token punctuation">)</span><span class="token punctuation">;</span>
  	
    <span class="token keyword">function</span> <span class="token function">Child</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">_classCallCheck</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> Child<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token function">_possibleConstructorReturn</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>Child<span class="token punctuation">.</span>__proto__ <span class="token operator">||</span> Object<span class="token punctuation">.</span><span class="token function">getPrototypeOf</span><span class="token punctuation">(</span>Child<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> Child<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">(</span>Parent<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// _possibleConstructorReturn 实现了 super</span>
<span class="token keyword">function</span> <span class="token function">_possibleConstructorReturn</span><span class="token punctuation">(</span><span class="token parameter">self<span class="token punctuation">,</span> call</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>self<span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ReferenceError</span><span class="token punctuation">(</span><span class="token string">&quot;this hasn't been initialised - super() hasn't been called&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token comment">// 显示绑定 Child 的内置 [[prototype]] 到 this，即在 Child 中执行 Child 原型链上关联的属性</span>
  <span class="token keyword">return</span> call <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> call <span class="token operator">===</span> <span class="token string">&quot;object&quot;</span> <span class="token operator">||</span> <span class="token keyword">typeof</span> call <span class="token operator">===</span> <span class="token string">&quot;function&quot;</span><span class="token punctuation">)</span> <span class="token operator">?</span> call <span class="token operator">:</span> self<span class="token punctuation">;</span> 
<span class="token punctuation">}</span>
<span class="token comment">// 核心: _inherits 函数，采用的依然也是第五种方式————寄生组合继承方式，同时证明了这种方式的成功; </span>
<span class="token comment">// 注意: 此处增加 Object.setPrototypeOf(subClass, superClass)，用来继承父类的静态方法, 此乃寄生组合遗漏地方</span>
</code></pre></div><h3 id="_2-3、es6-class-实现"><a href="#_2-3、es6-class-实现" class="header-anchor">#</a> 2-3、ES6 Class 实现</h3> <p>关于 ES6 写法与 ES5 的 Babel 对应(涉及super、extend实现原理，还有 getSet、公私静属性方法)；emmm，先不整，代码量偏多；</p> <h3 id="_2-4、多继承"><a href="#_2-4、多继承" class="header-anchor">#</a> 2-4、多继承</h3> <p>别搞多继承，JS Class 写法不是给你写这个的，而是方便你开发，多继承会有很多状态二义性、执行优先级等问题；现有方式与语言特性难以实现；</p> <h2 id="三、设计模式"><a href="#三、设计模式" class="header-anchor">#</a> 三、设计模式</h2> <p>设计模式的使用多见于模块制作、组件抽离、npm包(比如 vue-rx 内部使用到了单例模式、原型模式、适配器模式等)、软件架构设计乃至系统架构设计上(Rxjs + Node 的事件发布机制)；个人感觉它们所体现的开发设计思想比各类实现更为重要(当然代码实现也很重要不能停留书上 =。=)；此处只列举 JS 常见的设计模式(跟业务相关，业务复杂才能接触到更多更强大巧妙的设计模式，憾恨毕业去不成大厂…)：</p> <p>软件(还包括类/函数)设计模式的设计原则，其中 JS 世界中最常用到的是：单一职责原则SRP、开放封闭原则OP；</p> <ul><li>S一Single Responsibility Principle单一职责原则
<ul><li>一个程序只做好一 -件事</li> <li>如果功能过于 复杂就拆分开，每个部分保持独立</li></ul></li> <li>O—OpenClosed Principle 开放/封闭原则
<ul><li>对扩展开放，对修改封闭</li> <li>增加需求时，扩展新代码，而非修改已有代码</li></ul></li> <li>L—Liskov Substitution Principle 里氏替换原则
<ul><li>子类能覆盖父类</li> <li>父类能出现的地方子类就能出现</li></ul></li> <li>I—Interface Segregation Principle接口隔离原则
<ul><li>保持接口的单一独立</li> <li>类似单一职责原则，这里更关注接口</li></ul></li> <li>D—Dependency Inversion Principle 依赖倒转原则
<ul><li>面向接口编程， 依赖于抽象而不依赖于具体</li> <li>使用方只关注接口 而不关注具体类的实现</li></ul></li></ul> <p><strong><u>JS常用之一：单一职责原则—SRP(Single Responsibility Principle)-</u></strong></p> <ul><li>基本：一个方法、一个类只负责一个职责，各个职责的程序改动，不影响其它程序；</li> <li>比如：组件化、模块化；</li></ul> <p><strong><u>JS常用之二：开放封闭原则—OP(OpenClosed Principle)</u></strong></p> <ul><li>基本：核心思想是软件实体(类、模块、函数等)是可扩展的、但不可修改；即对扩展是开放的，而对修改是封闭的</li> <li>比如：类、模块和函数，应当对扩展开放，但对修改关闭；</li></ul> <h3 id="_3-1、单例模式"><a href="#_3-1、单例模式" class="header-anchor">#</a> 3-1、单例模式</h3> <p>顾名思义，保证只有一个类实例，并提供访问其的全局访问点；优点有很多，比如划分命名空间，减少全局变量、实例仅需1次、简化代码，便于调试和维护、增强模块性；但缺点也明显：单点访问、可能导致模块间的强耦合，不利于单元测试(无法单独测试一个调用了来自单例的方法的类，而只能把它与那个单例作为一个单元一起测试)；应用就更多了：登录控件、模态框、注销删除控件、vuex、redux 中的 store、<code>JQ的$</code> 都有它的身影；可细分为惰性单例(即利用闭包去延迟执行)</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">SingletonLogin</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span>password</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
    <span class="token keyword">this</span><span class="token punctuation">.</span>password <span class="token operator">=</span> password
  <span class="token punctuation">}</span>
  <span class="token keyword">static</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span>password</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// 经典实现: if(!this.xxx) Vuex 里面也有体现</span>
    <span class="token comment">// 判断对象是否已经被创建,若创建则返回旧对象</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>instance<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SingletonLogin</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span>password<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>instance
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
 
<span class="token keyword">let</span> obj1 <span class="token operator">=</span> SingletonLogin<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">'TLP'</span><span class="token punctuation">,</span><span class="token string">'123'</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> obj2 <span class="token operator">=</span> SingletonLogin<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">'TLP'</span><span class="token punctuation">,</span><span class="token string">'321'</span><span class="token punctuation">)</span>
 
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj1<span class="token operator">===</span>obj2<span class="token punctuation">)</span>    <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj1<span class="token punctuation">)</span>           <span class="token comment">// {name:TLP,password:123}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj2<span class="token punctuation">)</span>           <span class="token comment">// {name:TLP,password:123} - same result</span>
</code></pre></div><h3 id="_3-2、工厂模式"><a href="#_3-2、工厂模式" class="header-anchor">#</a> 3-2、工厂模式</h3> <p>个人感觉其是一种多态实现；用于创建对象的接口，此接口由子类决定实例化哪个类(而这些类 <strong><u>通常都拥有相同的接口(属性和方法</u></strong>))；</p> <p>意义在于：父类即抽象类，存放一般性问题的处理与相同方法，随着子类构建而被其继承，子类间相互独立，负责具体业务逻辑；减少了代码冗余、降低了耦合度、提高了扩展性、灵活性高(子类可在父类基础上自定义接口)；此外，还使得构造函数和创建者分离，相同方法在父类中编写，符合 OP—开闭原则；但是，扩展时须引入抽象类，需要理解其内部实现才可扩展(但实际开发中人员水平是参差不齐的，容易埋 bug)；应用地方也有很多： JQ(所用思想真滴厉害)、<code>React.createElement()</code>、<code>Vue.component()</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 简单工厂模式</span>
<span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> auth</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
    <span class="token keyword">this</span><span class="token punctuation">.</span>auth <span class="token operator">=</span> auth
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">UserFactory</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token function">createUser</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> auth</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 工厂内部封装了创建对象的逻辑:</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>auth <span class="token operator">===</span> <span class="token string">'admin'</span><span class="token punctuation">)</span>  <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>auth <span class="token operator">===</span> <span class="token string">'user'</span><span class="token punctuation">)</span>  <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> admin <span class="token operator">=</span> UserFactory<span class="token punctuation">.</span><span class="token function">createUser</span><span class="token punctuation">(</span><span class="token string">'TLP'</span><span class="token punctuation">,</span> <span class="token string">'admin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> user <span class="token operator">=</span> UserFactory<span class="token punctuation">.</span><span class="token function">createUser</span><span class="token punctuation">(</span><span class="token string">'TLP'</span><span class="token punctuation">,</span> <span class="token string">'user'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><img src="https://leibnize-picbed.oss-cn-shenzhen.aliyuncs.com/img/20200909091219.png" align="" style="zoom:50%;"> <h3 id="_3-3、观察者与发布订阅模式"><a href="#_3-3、观察者与发布订阅模式" class="header-anchor">#</a> 3-3、观察者与发布订阅模式</h3> <p>前者估计是前端最原始、最常用的开发模式了，为何? 抛你一个 addEventListener…；</p> <p>至于为何放在一起讲，因为感觉两者区别不大，后者比前者多了一个调度中心 (ps：此乃思考不成熟的体现，两者还是有较大差异的，体现在前者只有两点关系，若这种关系过多，管理就会显得十分复杂、代码也会变得臃肿，久而久之会出大问题；而后者通过中间调度器去管理，也有配套的取消订阅的操作(前者取消观察需要自实现)，在大型应用或软件开发中更显效率与精简)；</p> <p><strong><u>观察者模式</u></strong>：一种一对一或一对多的关系模式，观察者监听被观察者的变化，被观察者发生改变时，通知所有的观察者；较适用于小型的、一对象的改变需同时改变其它对象且不知道有多少对象需要改变时的场景；优点显而易见，灵活性相当高(坑点)，类似广播通信，自动通知所有已订阅过的对象、解耦(让耦合双方均依赖于抽象，而非依赖具体，使各自变化而不会影响另一边)，能单独扩展及重用；缺点：过度使用会导致对象与对象间联系弱化，难以跟踪维护和理解(比如 Angular 的 Subject…)；</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 观察者</span>
<span class="token keyword">class</span> <span class="token class-name">Observer</span> <span class="token punctuation">{</span>    
  <span class="token function">constructor</span> <span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      
    <span class="token keyword">this</span><span class="token punctuation">.</span>update <span class="token operator">=</span> fn    
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 被观察者</span>
<span class="token keyword">class</span> <span class="token class-name">Subject</span> <span class="token punctuation">{</span>    
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        
        <span class="token keyword">this</span><span class="token punctuation">.</span>observers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>          <span class="token comment">// 观察者队列    </span>
    <span class="token punctuation">}</span>    
    <span class="token function">addObserver</span><span class="token punctuation">(</span><span class="token parameter">observer</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>          
        <span class="token keyword">this</span><span class="token punctuation">.</span>observers<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>observer<span class="token punctuation">)</span><span class="token comment">// 往观察者队列添加观察者    </span>
    <span class="token punctuation">}</span>    
    <span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                       <span class="token comment">// 通知所有观察者,实际上是把观察者的 update()都执行了一遍       </span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>observers<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">observer</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>        
            observer<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment">// 依次取出观察者,并执行观察者的 update 方法        </span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>    
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> subject <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Subject</span><span class="token punctuation">(</span><span class="token punctuation">)</span>       <span class="token comment">// 被观察者</span>
<span class="token keyword">const</span> <span class="token function-variable function">update</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'被观察者发出通知'</span><span class="token punctuation">)</span><span class="token punctuation">}</span>  <span class="token comment">//收到广播时要执行的方法</span>
<span class="token keyword">var</span> ob1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Observer</span><span class="token punctuation">(</span>update<span class="token punctuation">)</span>    <span class="token comment">// 观察者1</span>
<span class="token keyword">var</span> ob2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Observer</span><span class="token punctuation">(</span>update<span class="token punctuation">)</span>    <span class="token comment">// 观察者2</span>
subject<span class="token punctuation">.</span><span class="token function">addObserver</span><span class="token punctuation">(</span>ob1<span class="token punctuation">)</span>          <span class="token comment">// 观察者1订阅 subject 的通知</span>
subject<span class="token punctuation">.</span><span class="token function">addObserver</span><span class="token punctuation">(</span>ob2<span class="token punctuation">)</span>          <span class="token comment">// 观察者2订阅 subject 的通知</span>
subject<span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span>                  <span class="token comment">// 发出广播,执行所有观察者的 update 方法</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 实现 node 中回调函数的机制，node 中回调函数其实是内部使用了观察者模式</span>
<span class="token keyword">function</span> <span class="token function">EventEmitter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>events <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 需要实现的一些方法：</span>
<span class="token comment">// addListener、removeListener、once、removeAllListeners、emit</span>

<span class="token comment">// 模拟实现addlistener方法</span>
<span class="token keyword">const</span> <span class="token function-variable function">wrapCallback</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> once <span class="token operator">=</span> <span class="token boolean">false</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> callback<span class="token operator">:</span> fn<span class="token punctuation">,</span> once <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">EventEmitter</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">addListener</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> fn<span class="token punctuation">,</span> once <span class="token operator">=</span> <span class="token boolean">false</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> hanlder <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>events<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>hanlder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 没有type绑定事件</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>events<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> <span class="token function">wrapCallback</span><span class="token punctuation">(</span>fn<span class="token punctuation">,</span> once<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>hanlder <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> hanlder<span class="token punctuation">.</span>callback <span class="token operator">===</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 目前type事件只有一个回调</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>events<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> <span class="token punctuation">[</span>hanlder<span class="token punctuation">,</span> <span class="token function">wrapCallback</span><span class="token punctuation">(</span>fn<span class="token punctuation">,</span> once<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// 目前type事件数&gt;=2</span>
    hanlder<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">wrapCallback</span><span class="token punctuation">(</span>fn<span class="token punctuation">,</span> once<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 模拟实现removeListener</span>
<span class="token class-name">EventEmitter</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">removeListener</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> listener</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> hanlder <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>events<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>hanlder<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>events<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>hanlder<span class="token punctuation">.</span>callback <span class="token operator">===</span> listener<span class="token punctuation">.</span>callback<span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">.</span>events<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> hanlder<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> item <span class="token operator">=</span> hanlder<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>item<span class="token punctuation">.</span>callback <span class="token operator">===</span> listener<span class="token punctuation">.</span>callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      hanlder<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      i<span class="token operator">--</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>hanlder<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>events<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> hanlder<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 模拟实现once方法</span>
<span class="token class-name">EventEmitter</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">once</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> listener</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> listener<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 模拟实现emit方法</span>
<span class="token class-name">EventEmitter</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">emit</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> hanlder <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>events<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>hanlder<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>hanlder<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    hanlder<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      item<span class="token punctuation">.</span><span class="token function">callback</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>item<span class="token punctuation">.</span>once<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">removeListener</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    hanlder<span class="token punctuation">.</span><span class="token function">callback</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>hanlder<span class="token punctuation">.</span>once<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>events<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">EventEmitter</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">removeAllListeners</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">type</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> hanlder <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>events<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>hanlder<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>events<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong><u>发布订阅模式</u></strong>：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> Event <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> list <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token comment">// 监听函数</span>
  <span class="token keyword">var</span> listen<span class="token punctuation">;</span> 
  <span class="token comment">// 移除监听函数</span>
  <span class="token keyword">var</span> remove<span class="token punctuation">;</span> 
  <span class="token comment">// 触发器 - 调度器</span>
  <span class="token keyword">var</span> trigger<span class="token punctuation">;</span> 
  <span class="token function-variable function">listen</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>list<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> list<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    list<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token function-variable function">remove</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> fns <span class="token operator">=</span> list<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>fns<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>fn<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      fns <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>fns<span class="token punctuation">.</span>length <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> fns<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> _fn <span class="token operator">=</span> fns<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>_fn <span class="token operator">===</span> fn<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          fns<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token function-variable function">trigger</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> key <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">,</span> fns <span class="token operator">=</span> list<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>fns <span class="token operator">||</span> fns<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> fn<span class="token punctuation">;</span> <span class="token punctuation">(</span>fn <span class="token operator">=</span> fns<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    listen<span class="token punctuation">,</span>
    trigger<span class="token punctuation">,</span>
    remove<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">d1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;first&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">d2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;second&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
Event<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token string">&quot;color&quot;</span><span class="token punctuation">,</span> d1<span class="token punctuation">)</span><span class="token punctuation">;</span> 	<span class="token comment">// d1</span>
Event<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token string">&quot;color&quot;</span><span class="token punctuation">,</span> d2<span class="token punctuation">)</span><span class="token punctuation">;</span> 	<span class="token comment">// d2</span>
Event<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token string">&quot;color&quot;</span><span class="token punctuation">,</span> d1<span class="token punctuation">)</span><span class="token punctuation">;</span> 	<span class="token comment">// d1</span>
Event<span class="token punctuation">.</span><span class="token function">trigger</span><span class="token punctuation">(</span><span class="token string">&quot;color&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 		<span class="token comment">// second</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">EventEmitter</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>cache <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function">on</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>cache<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>cache<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>cache<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>fn<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function">off</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> tasks <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cache<span class="token punctuation">[</span>name<span class="token punctuation">]</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>tasks<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> index <span class="token operator">=</span> tasks<span class="token punctuation">.</span><span class="token function">findIndex</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">f</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> f <span class="token operator">===</span> fn <span class="token operator">||</span> f<span class="token punctuation">.</span>callback <span class="token operator">===</span> fn<span class="token punctuation">)</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        tasks<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function">emit</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>cache<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 创建副本，如果回调函数内继续注册相同事件，会造成死循环</span>
      <span class="token keyword">const</span> tasks <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cache<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> fn <span class="token keyword">of</span> tasks<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function">emit</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> once <span class="token operator">=</span> <span class="token boolean">false</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>cache<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 创建副本，如果回调函数内继续注册相同事件，会造成死循环</span>
      <span class="token keyword">const</span> tasks <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cache<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> fn <span class="token keyword">of</span> tasks<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>once<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">delete</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cache<span class="token punctuation">[</span>name<span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 测试</span>
<span class="token keyword">const</span> eventBus <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EventEmitter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">task1</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'task1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token function-variable function">task2</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'task2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
eventBus<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'task'</span><span class="token punctuation">,</span> task1<span class="token punctuation">)</span>
eventBus<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'task'</span><span class="token punctuation">,</span> task2<span class="token punctuation">)</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  eventBus<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'task'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_3-x、其他模式"><a href="#_3-x、其他模式" class="header-anchor">#</a> 3-X、其他模式</h3> <p>待添加：适配器模式、代理模式、装饰器模式(TS、Angular)；面向组合设计；</p> <h2 id="四、架构模式"><a href="#四、架构模式" class="header-anchor">#</a> 四、架构模式</h2> <p>如何区分设计模式与架构模式，emmm，后者是一个根的定性问题，前者是枝的处理方式；比如种树，架构模式偏向于你要选用什么树、种在哪里、成本维护算计、种多少、用来干嘛等等，而设计模式更偏向于树种了之后，怎么培育、怎么打理、怎么束型等等；</p> <p>软件架构模式—<strong><u><em>Architectural Pattern</em></u></strong>：MVC，MVP，MVVM，均是常见的软件架构模式(Architectural Pattern)；</p> <p>软件架构模式通过分离关注点，来改进代码的组织方式，且相对独立不影响；</p> <ul><li>相同部分：<strong><u><em>MV(Model-View)</em></u></strong></li> <li>不同部分：<strong><u><em>C(Controller)、P(Presenter)、VM(View-Model)</em></u></strong></li></ul> <p>架构模式不同于设计模式 (Design Pattern)(明显比我上面说的更专业………)</p> <ul><li><p>前者往往使用了多种设计模式；</p></li> <li><p>后者只是为了解决一类问题而总结出的抽象方法；</p></li> <li><p><strong><u>Model</u></strong>：应用程序中，用于处理应用程序数据逻辑的部分；</p> <ul><li>用于封装和应用程序的业务逻辑相关的数据以及对数据的处理方法；</li> <li>通常负责在数据库中存取 <strong><u>管理数据</u></strong>；</li></ul></li> <li><p><strong><u>View</u></strong>：应用程序中，用于处理数据显示的部分；</p> <ul><li>通常依据模型数据 <strong><u>依据数据创建视图</u></strong>；</li></ul></li> <li><p><strong><u>Controller</u></strong>：应用程序中，用于处理用户交互的部分；</p> <ul><li>用于连接 Model &amp; View，控制应用程序流程，定义用户界面对用户输入响应方式，处理用户行为和数据上的改变；</li> <li>通常负责从 View 读取数据，控制用户输入，并向 Model 发送数据，是一个 <strong><u>业务逻辑处理—中间件</u></strong>；</li></ul></li></ul> <h3 id="_4-1、mvc"><a href="#_4-1、mvc" class="header-anchor">#</a> 4-1、MVC</h3> <img src="https://leibnize-picbed.oss-cn-shenzhen.aliyuncs.com/img/20200909091221.png" align="" style="zoom:50%;"> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
 * 基本:
 * View 负责接收用户的输入操作，Controller 负责业务逻辑的处理，Model 负责数据管理或持久化，Controller 将结果反馈给 View
 * 优点:
 * 简化分组开发，实现同时开发；
 * 利于管理，让开发人员更专注于开发；
 * 职责明确，独立改变而不影响，较高的灵活性和重用性；
 * 缺点:
 * Controller 集中了过多业务逻辑；
 * View 与 Controller 间耦合重，难以复用；
 * 当每个事件都流经 Controller 时，Controller 变得臃肿；
 */</span>

<span class="token keyword">const</span> <span class="token constant">MVC</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">$</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Model 用于存储业务数据，数据发生变化，Model 将通知 View；</span>
<span class="token constant">MVC</span><span class="token punctuation">.</span><span class="token function-variable function">Model</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> val <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> views <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token keyword">if</span><span class="token punctuation">(</span>val <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> val<span class="token operator">+=</span> v <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">sub</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token keyword">if</span><span class="token punctuation">(</span>val <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> val <span class="token operator">-=</span> v<span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">getVal</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> val<span class="token punctuation">;</span>

  <span class="token comment">// Model 和 View 间使用观察者模式</span>
  <span class="token comment">// View 事先在 Model 上注册从而观察 Model</span>
  <span class="token comment">// 当 Model 上数据发生改变时 View 则及时刷新(Controller)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">register</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">view</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> views<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>view<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">notify</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> views<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      views<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token constant">MVC</span><span class="token punctuation">.</span><span class="token function-variable function">View</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">controller</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> $num <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#num'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> $incBtn <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#increase'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> $decBtn <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#decrease'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// Controller 和 View 间使用策略模式</span>
  <span class="token comment">// View 引入 Controller 的实例 来实现特定的响应策略，如其中的按钮的 click 事件</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">render</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">model</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> $num<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span>model<span class="token punctuation">.</span><span class="token function">getVal</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'rmb'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  $incBtn<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span>controller<span class="token punctuation">.</span>increase<span class="token punctuation">)</span><span class="token punctuation">;</span>
  $decBtn<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span>controller<span class="token punctuation">.</span>decrease<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token constant">MVC</span><span class="token punctuation">.</span><span class="token function-variable function">Controller</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> model <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> view1 <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token comment">// 在 Controller 中响应 View 的事件并调用 Model 的接口对数据进行操作，一旦 Model 发生变化便通知 View 进行更新；</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">init</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    model <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MVC<span class="token punctuation">.</span>Model</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    view1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MVC<span class="token punctuation">.</span>View</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// ....</span>
    <span class="token comment">// 注册视图</span>
    model<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span>view1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// ....</span>
    <span class="token comment">// 渲染</span>
    model<span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">increase</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    model<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    model<span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">decrease</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    model<span class="token punctuation">.</span><span class="token function">sub</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    model<span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">const</span> controller <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MVC<span class="token punctuation">.</span>controller</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  controller<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_4-2、mvp"><a href="#_4-2、mvp" class="header-anchor">#</a> 4-2、MVP</h3> <img src="https://leibnize-picbed.oss-cn-shenzhen.aliyuncs.com/img/20200909091226.png" align="" style="zoom:50%;"> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
 * 基本:
 * MVP 是 MVC 模式的改良
 * 其将 MVC 中的 Controller 换为 Presenter-呈现，同样负责业务逻辑；
 * 即 View 负责控件组成的页面，Model 负责实体数据库操作；
 * 而 View 和 Model 间的控件数据绑定操作则属于 Presenter，目的时隔绝 View 和 Model 间的通信
 * View 不再像 MVC 那样直接访问 Model，而此任务交由 Presenter 负责；
 * 优点:
 * 与 MVC 相比，解决了无法实现多个 View 共用一个 Controller的问题，降低 View 和 Controller 耦合度，可复用性提高
 * 与 MVC 相比，MVP 模式通过解耦 View 和 Model ，使职责划分更加清晰
 * 隔绝 View 和 Model，可将 View 抽离封装成组件(往后只需提供接口提供给上层操作即可)
 * 缺点:
 * Presenter 还是很重，维护困难；
 * Presenter 负责基本业务逻辑，还需管理 View 与 Model 间的数据流动；
 * 由于没有数据绑定，若 View 需求增多，Presenter 也要改变
 */</span>

<span class="token keyword">const</span> <span class="token constant">MVP</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">$</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 与 MVC 相比，MVP 模式通过解耦 View 和 Model ，使职责划分更加清晰</span>
<span class="token constant">MVP</span><span class="token punctuation">.</span><span class="token function-variable function">Model</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> val <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token keyword">if</span><span class="token punctuation">(</span>val <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> val<span class="token operator">+=</span> v <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">sub</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token keyword">if</span><span class="token punctuation">(</span>val <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> val <span class="token operator">-=</span> v<span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">getVal</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> val<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token constant">MVP</span><span class="token punctuation">.</span><span class="token function-variable function">View</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> $num <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#num'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> $incBtn <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#increase'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> $decBtn <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#decrease'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">render</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">model</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> $num<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span>model<span class="token punctuation">.</span><span class="token function">getVal</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'rmb'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 用户对 View 的操作都转移到了Presenter</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">init</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> presenter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MVP<span class="token punctuation">.</span>Presenter</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    $incBtn<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span>presenter<span class="token punctuation">.</span>increase<span class="token punctuation">)</span><span class="token punctuation">;</span>
    $decBtn<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span>presenter<span class="token punctuation">.</span>decrease<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token constant">MVP</span><span class="token punctuation">.</span><span class="token function-variable function">Presenter</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">view</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Presenter 负责基本的业务逻辑，并管理 从 View 与 View 间的数据流动；</span>
  <span class="token keyword">const</span> _model <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MVP<span class="token punctuation">.</span>Model</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> _view <span class="token operator">=</span> view<span class="token punctuation">;</span>

  _view<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>_model<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">increase</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    _model<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    _view<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>_model<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">decrease</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    _model<span class="token punctuation">.</span><span class="token function">sub</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    _view<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>_model<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">const</span> view <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MVC<span class="token punctuation">.</span>View</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  view<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_4-3、mvvm"><a href="#_4-3、mvvm" class="header-anchor">#</a> 4-3、MVVM</h3> <p>ViewModel 是由前端开发人员组织生成和维护的视图数据层</p> <p>开发者对从后端获取的 Model 数据进行转换处理，做二次封装，以生成符合 View 层使用预期的视图数据模型；</p> <p>注意 ViewModel 所封装出来的数据模型，包括视图的状态和行为两部分，而 Model 层的数据模型是只包含状态</p> <p>比如页面展示什么，加载时发生什么，点击发生什么，滚动发生什么均属于视图行为，而视图状态和行为都封装在了 ViewModel 中</p> <p>如此封装使得 ViewModel 可完整地去描述 View 层</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
 * 基本:
 * MVP 是 MVC 模式的改良，而 MVVM 则是变革
 * MVVM 将数据模型的，数据双向绑定的思想作为核心；
 * MVVM 将 View 和 Model 的同步逻辑自动化，之间的同步不再需手动操作，而是交由框架提供的数据绑定功能来负责处理；
 * 即只需告诉框架 V层 显示的数据，对应 M层哪一部分即可；
 * 至此，V层 数据的变化会同时修改 M层的数据源，而 M层的数据变化也会立即反应到 V层上；
 * ViewModel 是整个模式的重点，业务逻辑也主要集中在这里，其中的一大核心就是数据绑定；
 * 
 * 优点:
 * 与 MVC/P 相比，简化业务与界面的依赖，解决数据频繁更新的问题；
 * 与 MVC/P 相比，V 层 和 M 层分离，低耦合，提高可复用性；
 * 与 MVC/P 相比，MVVM 中的 View 通过使用模板语法来声明式的将数据渲染进 DOM；
 * VM 对Model 进行更新时，会通过数据绑定，更新到 View
 */</span>

<span class="token constant">MVVM</span><span class="token punctuation">.</span><span class="token function-variable function">Model</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Model: 在 MVVM 中，可将 Model 称为数据模型，仅关注数据本身，不关心任何行为；</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    val<span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// View: 用户操作界面 当 VM 对 Model 进行更新时，会通过数据绑定，更新到 View；</span>
<span class="token comment">// MVVM 中的 View 通过使用模板语法来声明式的将数据渲染进 DOM</span>
<span class="token constant">MVVM</span><span class="token punctuation">.</span><span class="token function-variable function">View</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    &lt;div id=&quot;root&quot;&gt;
      &lt;p&gt;{{val}}&lt;/p&gt;
      &lt;button $click=&quot;sub(1)&quot;&gt;减1&lt;/button&gt;
      &lt;button $click=&quot;add(1)&quot;&gt;加1&lt;/button&gt;
    &lt;/div&gt;
  </span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span>

<span class="token constant">MVVM</span><span class="token punctuation">.</span><span class="token function-variable function">ViewModel</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 内部实现隐藏</span>
  <span class="token comment">// 实现数据绑定，或 Vue 的通过 Object.defineProperty 或 Ng 通过 Zone 触发然后新旧值比对</span>
<span class="token punctuation">}</span>

<span class="token keyword">new</span> <span class="token class-name">MVVM<span class="token punctuation">.</span>ViewModel</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  el<span class="token operator">:</span> <span class="token string">'#root'</span><span class="token punctuation">,</span>
  data<span class="token operator">:</span> <span class="token constant">MVVM</span><span class="token punctuation">.</span>Model<span class="token punctuation">,</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>val <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">.</span>val <span class="token operator">+=</span> v<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">sub</span><span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>val <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">.</span>val <span class="token operator">-=</span> v<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>


<span class="token comment">// 总之</span>
<span class="token comment">// MVVM 模式简化了界面与业务的依赖，解决了数据频繁更新；</span>
<span class="token comment">// 在使用当中，利用双向绑定技术，使得 Model 变化时，ViewModel 会自动更新，而 ViewModel 变化时，View 也会自动变化</span>
</code></pre></div><p>MVVM 框架实现了双向绑定</p> <p>这样 ViewModel 的内容会实时展现在 View 层，前端开发者再也不必低效且麻烦地通过操纵 DOM 去更新视图</p> <p>MVVM 框架已经把最脏最累的一块做好了，开发者只需要处理和维护 ViewModel，更新数据视图就会自动得到相应更新；</p> <p>这样 View 层展现的不是 Model 层的数据，而是 ViewModel 的数据，由 ViewModel 负责与 Model 层交互 即完全解耦 View 层和 Model 层；</p></div> <footer class="page-edit" style="display:none;"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">9/27/2020, 11:17:54 AM</span></div></footer> <!----> <!----> <!----></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div></div></div>
    <script src="/assets/js/app.f95d0077.js" defer></script><script src="/assets/js/3.49babee5.js" defer></script><script src="/assets/js/1.269e4bda.js" defer></script><script src="/assets/js/87.472635cc.js" defer></script>
  </body>
</html>
