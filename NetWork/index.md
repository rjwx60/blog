---
typora-root-url: ../../BlogImgsBed/Source
---



### 一、OSI 七层模型

即应用层、表示层、会话层、传输层、网络层、数据链路层、物理层

```
application layer、presentation layer、session layer、transport layer、network layer、data link layer、physical layer
```



<img src="/Image/NetWork/index/17.png" style="zoom:50%;" />

<img src="/Image/NetWork/index/18.png" style="zoom:50%;" />





### 二、CDN

CDN（Content Delivery Network）就是内容分发网络；

为突破现实生活中的光速、传输距离等物理限制，CDN 投入了大量资金，在全球范围内各大枢纽城市建立机房，部署大量高存储高带宽的节点，构建跨运营商、跨地域的专用高速传输网络；其中分为中心节点、区域节点、边缘节点等，在用户接入网络后，首先通过全局负载均衡 `(Global Sever Load Balance)`，简称 GSLB 算法负责调度，找到离用户最合适的节点。然后通过 HTTP 缓存代理技术进行缓存，缓存命中就返回给用户，否则就回源站去取。CDN 擅长缓存静态资源(图片、音频等)，当然也支持动态内容的缓存；

#### 2-1、基本

CDN 全称 Content Delivery Network，即内容分发网络。 CDN 是构建在现有网络基础之上的智能虚拟网络，依靠部署在各地的边缘服务器，通过中心平台的负载均衡、内容分发、调度等功能模块，使用户就近获取所需内容，降低网络拥塞，提高用户访问响应速度和命中率；

CDN 关键技术主要有：内容存储和分发技术；

CDN 作用是减少传播时延，寻找到最近的节点，是典型的"以空间换时间"技术；

- 比如：淘宝网站的资源大部分都部署到CDN节点上；
- 比如：某网站服务器全部署在一个地方，那么全国各地访问均集中到这里访问，但因每地访问此处时的延时不同，且源站容易负载过大挂掉； 解决方案使用 CDN，在全国各地多个区域中心部署 CDN 节点，使各地用户可就近访问，有效减少传播时延，并且大大降低源站的负载；

#### 2-2、CDN 访问过程

<img src="/Image/NetWork/index/1.png" style="zoom:50%;" align="left"/>

- 首先，用户点击网站页面上的内容 URL，经过本地 DNS 系统解析，DNS 系统会最终将域名的解析权交给 CNAME 指向的 CDN 专用 DNS 服务器；
- 然后，CDN 的 DNS 服务器将 CDN 的全局负载均衡设备 IP 地址返回用户；
- 然后，用户向 CDN 的全局负载均衡设备发起内容 URL 访问请求；
- 然后，CDN 全局负载均衡设备根据用户 IP 地址，及用户请求的内容 URL，选择一台用户所属区域的区域负载均衡设备，告诉用户向这台设备发起请求；
- 然后，区域负载均衡设备会为用户选择一台合适的缓存服务器提供服务，选择的依据如下，基于下述条件综合分析后，区域负载均衡设备会向全局负载均衡设备返回一台缓存服务器的 IP 地址；
  - 根据用户IP地址，判断哪一台服务器距用户最近；
  - 根据用户所请求的URL中携带的内容名称，判断哪一台服务器上有用户所需内容；
  - 查询各个服务器当前的负载情况，判断哪一台服务器尚有服务能力；
- 然后，全局负载均衡设备把服务器的 IP 地址返回给用户；
- 最后，用户向缓存服务器发起请求，缓存服务器响应用户请求，将用户所需内容传送到用户终端；若这台缓存服务器上并无用户想要的内容，而区域均衡设备依然将它分配给了用户，则此台服务器就要向它的上一级缓存服务器请求内容，直至追溯到网站的源服务器将内容拉到本地；



#### 2-3、CDN 回源机制

回源情况：当 CDN 缓存服务器中无符合用户要求的资源时，服务器会请求上级缓存服务器，以此类推，若最后还是没有，就会回到主服务器获取资源；

- 用户访问时，如节点上无缓存，则会回源拉取资源；
- CDN节点上的文件过期，会回源拉取资源；
- 若为不缓存文件，用户访问时，会直接回源拉取资源；



#### 2-4、OSS & CDN diff

OSS  全称 Object Storage Service，对象存储服务，其将数据通道(需要访问的数据)和控制通路(元数据，即索引)分离，先根据索引(也就是元数据)找到数据存储的位置，进而通过底层的存储接口来访问数据；通过此方式，对象存储既有类似块存储的存取性能，也有类似文件存储的共享便利，可极佳的存储方式；

场景：对象存储主要用来存储图片、音频、视频等非结构化数据；

<u>*区别：OSS 核心是存储及计算能力，CDN 核心是分发，本身不提供存储的接口，所以一般情况下是两者配合使用：对象存储中存储资源文件，并使用 CDN 加速*</u>；

<img src="/Image/NetWork/index/2.png" style="zoom:50%;" align="left"/>